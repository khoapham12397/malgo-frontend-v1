<div id="wiki-content">
<h1 class="pt-4">BÃ i toÃ¡n tÃ¬m cÃ¢y khung nhá» nháº¥t trong Ä‘á»“ thá»‹</h1>
<div class="breadcrumb"><nav aria-label="Breadcrumb"><ol>
<li class="breadcrumb-item"><a href="https://vnoi.info/wiki/gollum/overview/algo/">algo</a></li>
<li class="breadcrumb-item"><a href="https://vnoi.info/wiki/gollum/overview/algo/graph-theory/">graph-theory</a></li>
</ol></nav></div>
<div class>
<div id="wiki-body" class="gollum-markdown-content overflow-hidden ">
<div class="markdown-body ">
<p><strong>TÃ¡c giáº£</strong>:</p>
<ul>
<li>HoÃ ng Viá»‡t CÆ°á»ng - Äáº¡i há»c BÃ¡ch Khoa HÃ  Ná»™i</li>
<li>Phan ThÃ nh Long - THPT ChuyÃªn ThÃ¡i BÃ¬nh (K17-20)</li>
</ul>
<p><strong>Reviewer</strong>:
VÆ°Æ¡ng HoÃ ng Long - Äáº¡i há»c Quá»‘c Gia Singapore</p>
<h2 class="editable"><a class="anchor" id="má»™t-sá»‘-kiáº¿n-thá»©c-cáº§n-biáº¿t" href="#má»™t-sá»‘-kiáº¿n-thá»©c-cáº§n-biáº¿t"></a>Má»™t sá»‘ kiáº¿n thá»©c cáº§n biáº¿t</h2>
<p>VÃ¬ bÃ i viáº¿t nÃ³i vá» cÃ¢y khung nhá» nháº¥t, cÃ¡c báº¡n nÃªn Ä‘á»c má»™t sá»‘ kiáº¿n thá»©c liÃªn quan Ä‘áº¿n cÃ¢y trÆ°á»›c mÃ  mÃ¬nh liá»‡t kÃª dÆ°á»›i Ä‘Ã¢y vÃ¬ Ä‘Ã¢y lÃ  nhá»¯ng kiáº¿n thá»©c ráº¥t thÆ°á»ng gáº·p trong nhá»¯ng bÃ i táº­p vá» cÃ¢y khung, trong khuÃ´n khá»• bÃ i viáº¿t mÃ¬nh sáº½ khÃ´ng giáº£i thÃ­ch láº¡i vá» nhá»¯ng kiáº¿n thá»©c nÃ y ná»¯a:</p>
<ul>
<li><a href="https://vnoi.info/wiki/translate/topcoder/Range-Minimum-Query-and-Lowest-Common-Ancestor.md#b%C3%A0i-to%C3%A1n-lowest-common-ancestor-lca">Lowest Common Accessor</a></li>
<li><a href="https://vnoi.info/wiki/algo/data-structures/disjoint-set.md">Disjoin Set Union</a></li>
</ul>
<p><strong>LÆ°u Ã½:</strong> ToÃ n bá»™ pháº§n code phÃ­a dÆ°á»›i sá»­ dá»¥ng cho <code>C++11</code> trá»Ÿ lÃªn, cÃ¡c báº¡n lÆ°u Ã½ kiá»ƒm tra trÃ¬nh biÃªn dá»‹ch cá»§a mÃ¬nh.</p>
<h2 class="editable"><a class="anchor" id="cÃ¢y-khung-nhá»-nháº¥t-lÃ -gÃ¬" href="#cÃ¢y-khung-nhá»-nháº¥t-lÃ -gÃ¬"></a>CÃ¢y khung nhá» nháº¥t lÃ  gÃ¬</h2>
<h3 class="editable"><a class="anchor" id="Ä‘á»‹nh-nghÄ©a" href="#Ä‘á»‹nh-nghÄ©a"></a>Äá»‹nh nghÄ©a</h3>
<p>Theo lÃ½ thuyáº¿t Ä‘á»“ thá»‹, chÃºng ta Ä‘á»u biáº¿t ráº±ng 1 Ä‘á»“ thá»‹ Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng cÃ´ng thá»©c $G = (V, E)$, trong Ä‘Ã³ Ä‘á»“ thá»‹ $G$ cá»§a chÃºng ta bao gá»“m táº­p cÃ¡c Ä‘á»‰nh $V$ vÃ  táº­p cÃ¡c cáº¡nh $E$.</p>
<ul>
<li>
<strong>CÃ¢y khung (<em>spanning tree</em>)</strong> cá»§a Ä‘á»“ thá»‹ lÃ  má»™t táº­p há»£p cÃ¡c cáº¡nh cá»§a Ä‘á»“ thá»‹ thá»a mÃ£n táº­p cáº¡nh nÃ y <strong><em>khÃ´ng chá»©a chu trÃ¬nh</em></strong> vÃ  <strong><em>liÃªn thÃ´ng</em></strong> (tá»« má»™t Ä‘á»‰nh báº¥t kÃ¬ cÃ³ thá»ƒ Ä‘i tá»›i báº¥t ká»³ Ä‘á»‰nh nÃ o khÃ¡c theo mÃ  chá»‰ dÃ¹ng cÃ¡c cáº¡nh trÃªn <strong>cÃ¢y khung</strong>)</li>
<li>
<p>Trong Ä‘á»“ thá»‹ <strong>cÃ³ trá»ng sá»‘</strong>, <strong>cÃ¢y khung nhá» nháº¥t (<em>minimum spanning tree</em>)</strong> lÃ  <strong>cÃ¢y khung</strong> cÃ³ tá»•ng trá»ng sá»‘ cÃ¡c cáº¡nh trong cÃ¢y <strong>nhá» nháº¥t</strong>.</p>
</li>
<li>
<p>Má»™t vÃ­ dá»¥ vá» cÃ¢y khung trong Ä‘á»“ thá»‹ vÃ´ hÆ°á»›ng khÃ´ng trá»ng sá»‘:
<img src="https://i.imgur.com/QqWCZO0.png" /></p>
</li>
<li>Má»™t vÃ­ dá»¥ vá» cÃ¢y khung <strong>nhá» nháº¥t</strong> trong Ä‘á»“ thá»‹ vÃ´ hÆ°á»›ng cÃ³ trá»ng sá»‘:
<img src="https://i.imgur.com/egYfsfI.jpg" />
</li>
</ul>
<p>Trong khuÃ´n khá»• bÃ i viáº¿t, chÃºng ta sáº½ lÃ m viá»‡c vá»›i <strong>Ä‘á»“ thá»‹ vÃ´ hÆ°á»›ng cÃ³ trá»ng sá»‘</strong>.</p>
<h3 class="editable"><a class="anchor" id="tÃ­nh-cháº¥t" href="#tÃ­nh-cháº¥t"></a>TÃ­nh cháº¥t</h3>
<p>Má»™t vÃ i tÃ­nh cháº¥t cá»§a cÃ¢y khung nhá» nháº¥t trong Ä‘á»“ thá»‹ vÃ´ hÆ°á»›ng cÃ³ trá»ng sá»‘:</p>
<ul>
<li>
<p><strong>1. TÃ­nh cháº¥t chu trÃ¬nh</strong>: Trong má»™t chu trÃ¬nh $C$ báº¥t ká»³, náº¿u $e$ lÃ  cáº¡nh cÃ³ trá»ng sá»‘ lá»›n nháº¥t <strong>tuyá»‡t Ä‘á»‘i</strong> (khÃ´ng cÃ³ cáº¡nh nÃ o cÃ³ trá»ng sá»‘ báº±ng $e$) thÃ¬ $e$ khÃ´ng thá»ƒ náº±m trÃªn báº¥t ká»³ cÃ¢y khung nhá» nháº¥t nÃ o.</p>
</li>
<li>
<p><strong>2. ÄÆ°á»ng Ä‘i háº¹p nháº¥t</strong>: XÃ©t 2 Ä‘á»‰nh $u$, $v$ báº¥t ká»³ trong Ä‘á»“ thá»‹. Náº¿u $w$ lÃ  trá»ng sá»‘ cá»§a cáº¡nh lá»›n nháº¥t trÃªn Ä‘Æ°á»ng Ä‘i tá»« $u$ Ä‘áº¿n $v$ trÃªn cÃ¢y khung nhá» nháº¥t cá»§a Ä‘á»“ thá»‹ thÃ¬ ta khÃ´ng thá»ƒ tÃ¬m Ä‘Æ°á»£c Ä‘Æ°á»ng Ä‘i nÃ o tá»« $u$ Ä‘áº¿n $v$ trÃªn Ä‘á»“ thá»‹ ban Ä‘áº§u chá»‰ Ä‘i qua nhá»¯ng cáº¡nh cÃ³ trá»ng sá»‘ nhá» hÆ¡n $w$.</p>
</li>
<li>
<p><strong>3. TÃ­nh duy nháº¥t</strong>: Náº¿u táº¥t cáº£ cÃ¡c cáº¡nh Ä‘á»u cÃ³ trá»ng sá»‘ khÃ¡c nhau thÃ¬ chá»‰ cÃ³ duy má»™t cÃ¢y khung nhá» nháº¥t. NgÆ°á»£c láº¡i, náº¿u má»™t vÃ i cáº¡nh cÃ³ trá»ng sá»‘ giá»‘ng nhau thÃ¬ cÃ³ thá»ƒ cÃ³ nhiá»u hÆ¡n má»™t cÃ¢y khung nhá» nháº¥t.</p>
</li>
<li>
<p><strong>4. TÃ­nh cháº¥t cáº¡nh nhá» nháº¥t</strong>: Náº¿u $e$ lÃ  cáº¡nh cÃ³ trá»ng sá»‘ nhá» nháº¥t cá»§a Ä‘á»“ thá»‹, vÃ  khÃ´ng cÃ³ cáº¡nh nÃ o cÃ³ trá»ng sá»‘ báº±ng $e$ thÃ¬ $e$ náº±m trong má»i cÃ¢y khung nhá» nháº¥t cá»§a Ä‘á»“ thá»‹.</p>
</li>
</ul>
<h4 class="editable"><a class="anchor" id="chá»©ng-minh" href="#chá»©ng-minh"></a>Chá»©ng minh</h4>
<blockquote>
<p><strong>LÆ°u Ã½ :</strong> cÃ¡c báº¡n má»›i há»c cÃ¢y khung láº§n Ä‘áº§u cÃ¢n nháº¯c viá»‡c Ä‘á»c chá»©ng minh, tÃ¡c giáº£ khuyÃªn cÃ¡c báº¡n nÃªn táº¡m thá»i bá» qua pháº§n nÃ y</p>
</blockquote>
<p>XuyÃªn suá»‘t cáº£ bá»‘n tÃ­nh cháº¥t, ta Ä‘á»u sá»­ dá»¥ng phÃ©p pháº£n chá»©ng Ä‘á»ƒ chá»©ng minh</p>
<ul>
<li>
<strong>1. TÃ­nh cháº¥t chu trÃ¬nh</strong>:
Giáº£ sá»­ $e$ thuá»™c má»™t cÃ¢y khung $T$ cá»§a Ä‘á»“ thá»‹, ta sáº½ chá»©ng minh luÃ´n tá»“n táº¡i má»™t cÃ¢y khung khÃ¡c cá»§a Ä‘á»“ thá»‹ cÃ³ trá»ng sá»‘ nhá» hÆ¡n $T$.
<ul>
<li>Ta thá»­ xÃ³a cáº¡nh $e$ khá»i cÃ¢y khung $T$. LÃºc nÃ y, $T$ sáº½ bá»‹ chia lÃ m 2 thÃ nh pháº§n liÃªn thÃ´ng vÃ  tá»•ng trá»ng sá»‘ giáº£m Ä‘i $w_e$.</li>
<li>XÃ©t cÃ¡c Ä‘á»‰nh náº±m trong chu trÃ¬nh $C$, giáº£ sá»­ sau khi xÃ³a $e$ khá»i cÃ¢y khung, cÃ¡c Ä‘á»‰nh nÃ y váº«n liÃªn thÃ´ng vá»›i nhau. VÃ¬ tháº¿, khi thÃªm $e$ trá»Ÿ láº¡i vÃ o cÃ¢y khung, $e$ sáº½ káº¿t ná»‘i 2 Ä‘á»‰nh Ä‘Ã£ liÃªn thÃ´ng vá»›i nhau $\Rightarrow$ tá»“n táº¡i chu trÃ¬nh trong cÃ¢y khung $\Rightarrow$ TrÃ¡i vá»›i giáº£ thiáº¿t $T$ lÃ  cÃ¢y khung.
â‡’ Váº­y nÃªn, khi xÃ³a $e$ khá»i $T$, cÃ¡c Ä‘á»‰nh náº±m trong chu trÃ¬nh $C$ sáº½ bá»‹ tÃ¡ch lÃ m 2 thÃ nh pháº§n liÃªn thÃ´ng. Do Ä‘Ã³, ta cÃ³ thá»ƒ chá»n ra cáº¡nh $e'$ khÃ¡c $e$ thuá»™c chu trÃ¬nh $C$ Ä‘á»ƒ káº¿t ná»‘i 2 thÃ nh liÃªn thÃ´ng nÃ y, biáº¿n $T$ trá»Ÿ láº¡i thÃ nh má»™t cÃ¢y khung cá»§a Ä‘á»“ thá»‹. Máº·t khÃ¡c, $e$ lÃ  cáº¡nh cÃ³ trá»ng sá»‘ lá»›n nháº¥t tuyá»‡t Ä‘á»‘i trÃªn $C$, nÃªn khi thay $e$ báº±ng $e'$, trá»ng sá»‘ cá»§a T sáº½ giáº£m Ä‘i $w_e - w_{e'}$
<strong>Káº¿t luáº­n:</strong> T khÃ´ng pháº£i lÃ  cÃ¢y khung nhá» nháº¥t cá»§a Ä‘á»“ thá»‹.</li>
</ul>
</li>
<li>
<strong>2. ÄÆ°á»ng Ä‘i háº¹p nháº¥t</strong>:
<ul>
<li>XÃ©t cÃ¢y khung nhá» nháº¥t $T$ báº¥t ká»³ cá»§a Ä‘á»“ thá»‹ $G$ mÃ  tá»“n táº¡i Ä‘Æ°á»ng Ä‘i $u \rightarrow v$ trÃªn $G$ cÃ³ cáº¡nh lá»›n nháº¥t <strong>nhá» hÆ¡n</strong> cáº¡nh lá»›n nháº¥t cá»§a Ä‘Æ°á»ng Ä‘i $u \rightarrow v$ trÃªn $T$.</li>
<li>Gá»i Ä‘Æ°á»ng Ä‘i $u \rightarrow v$ trÃªn $G$ lÃ  $path$, cáº¡nh lá»›n nháº¥t cá»§a Ä‘Æ°á»ng Ä‘i $u \rightarrow v$ trÃªn $T$ lÃ  $e$.
â‡’ NhÆ° váº­y, náº¿u xÃ³a $e$ khá»i cÃ¢y khung ban Ä‘áº§u, cÃ¢y khung sáº½ bá»‹ chia thÃ nh 2 TPLT rá»i nhau, má»™t TPLT chá»©a $u$ vÃ  TPLT cÃ²n láº¡i chá»©a $v$.</li>
<li>Do $path$ lÃ  Ä‘Æ°á»ng Ä‘i $u \rightarrow v$ trÃªn $G$ nÃªn trÃªn $path$ sáº½ tá»“n táº¡i cáº¡nh $e'$ cÃ³ thá»ƒ káº¿t ná»‘i 2 TPLT nÃ y. MÃ  má»i cáº¡nh trÃªn $path$ Ä‘á»u cÃ³ trá»ng sá»‘ nhá» hÆ¡n $e$ (nhÆ° giáº£ thiáº¿t)
â‡’ Khi xoÃ¡ $e$ vÃ  thay báº±ng $e'$, ta sáº½ thu Ä‘Æ°á»£c 1 cÃ¢y khung $T'$ cÃ³ trá»ng sá»‘ nhá» hÆ¡n cÃ¢y khung ban Ä‘áº§u
<strong>Káº¿t luáº­n:</strong> $T$ khÃ´ng pháº£i cÃ¢y khung nhá» nháº¥t cá»§a Ä‘á»“ thá»‹.</li>
</ul>
</li>
<li>
<strong>3. TÃ­nh duy nháº¥t</strong>:
<ul>
<li>Giáº£ sá»­ tá»“n táº¡i 2 cÃ¢y khung nhá» nháº¥t $T$ vÃ  $T'$. XÃ©t cáº¡nh $u-v$ náº±m trong $T$ nhÆ°ng khÃ´ng trong $T'$.</li>
<li>Gá»i Ä‘Æ°á»ng Ä‘i $u \rightarrow v$ trÃªn $T$ lÃ  $path$, trÃªn $T'$ lÃ  $path'$. Hiá»ƒn nhiÃªn, $path'$ khÃ´ng chá»©a cáº¡nh $u-v$.</li>
<li>VÃ¬ trá»ng sá»‘ cÃ¡c cáº¡nh cá»§a Ä‘á»“ thá»‹ Ä‘á»u khÃ¡c nhau $\Rightarrow$ Cáº¡nh lá»›n nháº¥t cá»§a $path$ sáº½ cÃ³ trá»ng sá»‘ lá»›n hÆ¡n trá»ng sá»‘ cáº¡nh lá»›n nháº¥t cá»§a $path'$ hoáº·c ngÆ°á»£c láº¡i.
â‡’ Theo tÃ­nh cháº¥t Ä‘Æ°á»ng Ä‘i háº¹p nháº¥t, $T$ hoáº·c $T'$ sáº½ khÃ´ng pháº£i lÃ  cÃ¢y khung nhá» nháº¥t.</li>
</ul>
</li>
<li>
<strong>4. TÃ­nh cháº¥t cáº¡nh nhá» nháº¥t</strong>:
<blockquote>
<p>Ta sáº½ chá»©ng minh má»i cÃ¢y khung khÃ´ng chá»©a $e$ cá»§a Ä‘á»“ thá»‹ Ä‘á»u khÃ´ng pháº£i lÃ  cÃ¢y khung nhá» nháº¥t.</p>
</blockquote>
<ul>
<li>Giáº£ sá»­ $e$ ná»‘i 2 Ä‘á»‰nh $u$, $v$ cá»§a Ä‘á»“ thá»‹. Gá»i $T$ lÃ  1 cÃ¢y khung khÃ´ng chá»©a $e$ cá»§a Ä‘á»“ thá»‹.</li>
<li>XÃ©t cáº¡nh $e'$ báº¥t ká»³ thuá»™c Ä‘Æ°á»ng Ä‘i tá»« $u \rightarrow v$ trÃªn $T$. Khi xÃ³a $e'$ khá»i $T$, $T$ sáº½ bá»‹ tÃ¡ch lÃ m 2 thÃ nh pháº§n liÃªn thÃ´ng, 1 thÃ nh pháº§n liÃªn thÃ´ng chá»©a $u$, 1 pháº§n pháº§n liÃªn thÃ´ng chá»©a $v$.
â‡’ Do Ä‘Ã³, ta hoÃ n toÃ n cÃ³ thá»ƒ thÃªm cáº¡nh $e$ (ná»‘i 2 Ä‘á»‰nh $u- v$) vÃ o $T$ Ä‘á»ƒ káº¿t ná»‘i 2 thÃ nh pháº§n liÃªn thÃ´ng nÃ y, khi Ä‘Ã³ $T$ sáº½ trá»Ÿ láº¡i thÃ nh 1 cÃ¢y khung cá»§a Ä‘á»“ thá»‹.</li>
<li>Máº·t khÃ¡c, $e$ lÃ  cáº¡nh cÃ³ trá»ng sá»‘ nhá» nháº¥t tuyá»‡t Ä‘á»‘i cá»§a Ä‘á»“ thá»‹, nÃªn khi thay $e'$ báº±ng $e$ trÃªn cÃ¢y khung $T$, trá»ng sá»‘ cá»§a $T$ sáº½ giáº£m Ä‘i 1 lÆ°á»£ng dÆ°Æ¡ng
<strong>Káº¿t luáº­n:</strong> $T$ ban Ä‘áº§u khÃ´ng pháº£i lÃ  cÃ¢y khung nhá» nháº¥t cá»§a Ä‘á»“ thá»‹.</li>
</ul>
</li>
</ul>
<h2 class="editable"><a class="anchor" id="cÃ¡c-thuáº­t-toÃ¡n-tÃ¬m-cÃ¢y-khung-nhá»-nháº¥t" href="#cÃ¡c-thuáº­t-toÃ¡n-tÃ¬m-cÃ¢y-khung-nhá»-nháº¥t"></a>CÃ¡c thuáº­t toÃ¡n tÃ¬m cÃ¢y khung nhá» nháº¥t</h2>
<h3 class="editable"><a class="anchor" id="1-thuáº­t-toÃ¡n-kruskal" href="#1-thuáº­t-toÃ¡n-kruskal"></a>1. Thuáº­t toÃ¡n Kruskal</h3>
<p><strong>Ã tÆ°á»Ÿng thuáº­t toÃ¡n</strong>: Ban Ä‘áº§u má»—i Ä‘á»‰nh lÃ  má»™t cÃ¢y riÃªng biá»‡t, ta tÃ¬m cÃ¢y khung nhá» nháº¥t báº±ng cÃ¡ch duyá»‡t cÃ¡c cáº¡nh theo trá»ng sá»‘ tá»« nhá» Ä‘áº¿n lá»›n, rá»“i há»£p nháº¥t cÃ¡c cÃ¢y láº¡i vá»›i nhau.</p>
<p>Cá»¥ thá»ƒ hÆ¡n, giáº£ sá»­ cáº¡nh Ä‘ang xÃ©t ná»‘i 2 Ä‘á»‰nh $u$ vÃ  $v$, náº¿u 2 Ä‘á»‰nh nÃ y náº±m á»Ÿ 2 cÃ¢y khÃ¡c nhau thÃ¬ ta thÃªm cáº¡nh nÃ y vÃ o cÃ¢y khung, Ä‘á»“ng thá»i há»£p nháº¥t 2 cÃ¢y chá»©a $u$ vÃ  $v$.</p>
<p>Giáº£ sá»­ ta cáº§n tÃ¬m cÃ¢y khung nhá» nháº¥t cá»§a Ä‘á»“ thá»‹ $G$. Thuáº­t toÃ¡n bao gá»“m cÃ¡c bÆ°á»›c sau:</p>
<ul>
<li>Khá»Ÿi táº¡o rá»«ng $F$ (táº­p há»£p cÃ¡c cÃ¢y), trong Ä‘Ã³ má»—i Ä‘á»‰nh cá»§a G táº¡o thÃ nh má»™t cÃ¢y riÃªng biá»‡t.</li>
<li>Khá»Ÿi táº¡o táº­p $S$ chá»©a táº¥t cáº£ cÃ¡c cáº¡nh cá»§a $G$.</li>
<li>Chá»«ng nÃ o $S$ cÃ²n <strong>khÃ¡c rá»—ng</strong> vÃ  $F$ gá»“m <strong>hÆ¡n má»™t cÃ¢y</strong>
<ul>
<li>XÃ³a cáº¡nh nhá» nháº¥t trong $S$</li>
<li>Náº¿u cáº¡nh Ä‘Ã³ ná»‘i hai cÃ¢y khÃ¡c nhau trong $F$, thÃ¬ thÃªm nÃ³ vÃ o $F$ vÃ  há»£p hai cÃ¢y ká» vá»›i nÃ³ lÃ m má»™t</li>
<li>Náº¿u khÃ´ng thÃ¬ loáº¡i bá» cáº¡nh Ä‘Ã³.</li>
</ul>
</li>
</ul>
<p>Khi thuáº­t toÃ¡n káº¿t thÃºc, rá»«ng chá»‰ gá»“m Ä‘Ãºng má»™t cÃ¢y vÃ  Ä‘Ã³ lÃ  má»™t cÃ¢y khung nhá» nháº¥t cá»§a Ä‘á»“ thá»‹ $G$</p>
<p>VÃ­ dá»¥ cÃ¡c bÆ°á»›c giáº£i bÃ i toÃ¡n tÃ¬m cÃ¢y khung nhá» nháº¥t vá»›i thuáº­t toÃ¡n Kruskal :
<img src="https://i.imgur.com/ZvvusBq.gif" />
</p>
<p>Äá»ƒ thá»±c hiá»‡n thao tÃ¡c kiá»ƒm tra cáº¡nh vÃ  há»£p nháº¥t 2 cÃ¢y má»™t cÃ¡ch nhanh chÃ³ng, ta sá»­ dá»¥ng cáº¥u trÃºc <strong><a href="https://vnoi.info/wiki/algo/data-structures/disjoint-set.md">Disjoint Set</a></strong>, dÆ°á»›i Ä‘Ã¢y lÃ  Ä‘oáº¡n code dÃ¹ng Ä‘á»ƒ cÃ i Ä‘áº·t thuáº­t toÃ¡n:
</p><pre class="highlight"><code><span class="cm">/*input
4 4
1 2 1
2 3 2
3 4 3
4 1 4
*/</span>
<span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="c1">// Cáº¥u trÃºc Ä‘á»ƒ lÆ°u cÃ¡c cáº¡nh Ä‘á»“ thá»‹</span>
<span class="c1">// u, v lÃ  2 Ä‘á»‰nh, c lÃ  trá»ng sá»‘ cáº¡nh</span>
<span class="k">struct</span> <span class="nc">Edge</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
    <span class="n">Edge</span><span class="p">(</span><span class="kt">int</span> <span class="n">_u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_c</span><span class="p">)</span><span class="o">:</span> <span class="n">u</span><span class="p">(</span><span class="n">_u</span><span class="p">),</span> <span class="n">v</span><span class="p">(</span><span class="n">_v</span><span class="p">),</span> <span class="n">c</span><span class="p">(</span><span class="n">_c</span><span class="p">)</span> <span class="p">{};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">Dsu</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">par</span><span class="p">;</span>

    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">par</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="n">u</span><span class="p">)</span> <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="n">join</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span> <span class="n">v</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="n">dsu</span><span class="p">;</span>

<span class="c1">// n vÃ  m lÃ  sá»‘ Ä‘á»‰nh vÃ  sá»‘ cáº¡nh</span>
<span class="c1">// totalWeight lÃ  tá»•ng trá»ng sá»‘ cÃ¡c cáº¡nh trong cÃ¢y khung nhá» nháº¥t</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">totalWeight</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">vector</span> <span class="o">&lt;</span> <span class="n">Edge</span> <span class="o">&gt;</span> <span class="n">edges</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Fast IO</span>
    <span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">edges</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="n">dsu</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

    <span class="c1">// Sáº¯p xáº¿p láº¡i cÃ¡c cáº¡nh theo trá»ng sá»‘ tÄƒng dáº§n</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">edges</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="p">[](</span><span class="n">Edge</span> <span class="o">&amp;</span> <span class="n">x</span><span class="p">,</span> <span class="n">Edge</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">.</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="c1">// Duyá»‡t qua cÃ¡c cáº¡nh theo thá»© tá»± Ä‘Ã£ sáº¯p xáº¿p</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">e</span> <span class="o">:</span> <span class="n">edges</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Náº¿u khÃ´ng há»£p nháº¥t Ä‘Æ°á»£c 2 Ä‘á»‰nh u vÃ  v thÃ¬ bá» qua</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dsu</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>

        <span class="c1">// Náº¿u há»£p nháº¥t Ä‘Æ°á»£c u, v ta thÃªm trá»ng sá»‘ cáº¡nh vÃ o káº¿t quáº£</span>
        <span class="n">totalWeight</span> <span class="o">+=</span> <span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Xuáº¥t ra káº¿t quáº£</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">totalWeight</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span></code></pre>
<h4 class="editable"><a class="anchor" id="chá»©ng-minh-tÃ­nh-Ä‘Ãºng-Ä‘áº¯n-cá»§a-thuáº­t-toÃ¡n" href="#chá»©ng-minh-tÃ­nh-Ä‘Ãºng-Ä‘áº¯n-cá»§a-thuáº­t-toÃ¡n"></a>Chá»©ng minh tÃ­nh Ä‘Ãºng Ä‘áº¯n cá»§a thuáº­t toÃ¡n:</h4>
<p>Ta pháº£i chá»©ng minh hai Ä‘iá»u:</p>
<ol>
<li>Ä‘áº§u ra cá»§a thuáº­t toÃ¡n lÃ  má»™t cÃ¢y khung</li>
<li>cÃ¢y Ä‘Ã³ cÃ³ trá»ng sá»‘ nhá» nháº¥t trong sá»‘ táº¥t cáº£ cÃ¡c cÃ¢y khung cá»§a Ä‘á»“ thá»‹.</li>
</ol>
<p><strong>Chá»©ng minh (1)</strong></p>
<ul>
<li>Má»—i cáº¡nh $(u, v)$ Ä‘Æ°á»£c xÃ©t Ä‘áº¿n, nÃ³ chá»‰ káº¿t náº¡p vÃ o cÃ¢u khung náº¿u $u, v$ thuá»™c 2 thÃ nh pháº§n liÃªn thÃ´ng khÃ¡c nhau $T_u, T_v$ â‡’ Do Ä‘Ã³ cÃ¡c cáº¡nh Ä‘Æ°á»£c thÃªm khÃ´ng táº¡o thÃ nh chu trÃ¬nh</li>
<li>Do $T$ khÃ´ng cÃ³ chu trÃ¬nh â‡’ sá»‘ cáº¡nh Ä‘Æ°á»£c thÃªm $â‰¤ n - 1$. Ta sáº½ chá»©ng minh $T$ cÃ³ Ä‘Ãºng $n - 1$ cáº¡nh
<ul>
<li>Giáº£ sá»­ sá»‘ cáº¡nh Ä‘Æ°á»£c thÃªm $&lt; n - 1$ â‡’ $T$ gá»“m hai hay nhiá»u thÃ nh pháº§n liÃªn thÃ´ng</li>
<li>Máº·t khÃ¡c, do $G$ liÃªn thÃ´ng â‡’ tá»“n táº¡i cÃ¡c cáº¡nh thuá»™c $G$ ná»‘i cÃ¡c thÃ nh pháº§n liÃªn thÃ´ng Ä‘Ã³ mÃ  khÃ´ng thuá»™c $T$. Do Ä‘Ã³ cáº¡nh Ä‘áº§u tiÃªn nhá» nháº¥t trong sá»‘ cÃ¡c cáº¡nh nÃ y sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o do nÃ³ khÃ´ng táº¡o thÃ nh chu trÃ¬nh, mÃ¢u thuáº«n vá»›i giáº£ thiáº¿t á»Ÿ trÃªn â‡’ Giáº£ sá»­ sai</li>
<li>Váº­y sá»‘ cáº¡nh Ä‘Æ°á»£c thÃªm vÃ o báº±ng Ä‘Ãºng $n - 1$</li>
</ul>
</li>
</ul>
<p><strong>Chá»©ng minh (2)</strong></p>
<blockquote>
<p><strong><em>LÆ°u Ã½</em></strong> : Náº¿u báº¡n má»›i há»c cÃ¢y khung láº§n Ä‘áº§u tiÃªn chÆ°a nÃªn Ä‘á»c ngay chá»©ng minh nÃ y, vÃ¬ chÃºng cÃ³ thá»ƒ khiáº¿n báº¡n hoang mang. Chá»©ng minh cÃ³ sá»­ dá»¥ng má»™t sá»‘ khÃ¡i niá»‡m nhÆ° <strong><em>lÃ¡t cáº¯t</em></strong>, <strong><em>lÃ¡t cáº¯t háº¹p nháº¥t</em></strong></p>
</blockquote>
<p>Trong chá»©ng minh nÃ y, mÃ¬nh cÃ³ quy Æ°á»›c sá»­ dá»¥ng má»™t sá»‘ kÃ­ hiá»‡u:</p>
<ul>
<li>$|A|$ : sá»‘ lÆ°á»£ng pháº§n tá»­ cÃ³ trong táº­p há»£p $A$</li>
<li>$A - B$ : táº­p há»£p cÃ¡c pháº§n tá»­ thuá»™c $A$ mÃ  khÃ´ng thuá»™c $B$</li>
</ul>
<p>Giá» cÃ¹ng Ä‘i vÃ o chi tiáº¿t chá»©ng minh nhÃ© (ã¥â—” ÍœÊ–â—”)ã¥</p>
<ul>
<li>Gá»i $T$ lÃ  cÃ¢y khung Ä‘áº§u ra cá»§a thuáº­t toÃ¡n Kruskal vÃ  $T^*$ lÃ  má»™t cÃ¢y khung nhá» nháº¥t, ta sáº½ chá»©ng minh tá»•ng trá»ng sá»‘ trÃªn $T$ vÃ  $T^*$ báº±ng nhau : $c(T)$ = $c(T^*)$</li>
<li>Náº¿u $c(T)$ = $c(T^*)$ â‡’ hiá»ƒn nhiÃªn Ä‘Ãºng</li>
<li>Náº¿u $c(T)$ â‰  $c(T^*)$ gá»i $(u, v)$ lÃ  cáº¡nh $\in$ $T$ mÃ  $\notin$ $T^*$ hay thuá»™c $T - T^*$. Gá»i $S$ lÃ  thÃ nh pháº§n liÃªn thÃ´ng chá»©a u táº¡i thá»i Ä‘iá»ƒm $(u, v)$ Ä‘Æ°á»£c thÃªm vÃ o $T$.
<strong>Nháº­n xÃ©t:</strong>
Dá»… tháº¥y náº¿u xÃ³a cáº¡nh $(u, v)$ trÃªn $T$ thÃ¬ sáº½ tÃ¡ch thÃ nh 2 <strong>thÃ nh pháº§n liÃªn thÃ´ng</strong> $S$ vÃ  $G - S$.
ÄÃ¢y lÃ  má»™t <strong>lÃ¡t cáº¯t</strong>, ta cÃ³ thá»ƒ thÃªm báº¥t cá»© cáº¡nh nÃ o ná»‘i giá»¯a 2 <strong>thÃ nh pháº§n liÃªn thÃ´ng</strong> nÃ y Ä‘á»ƒ táº¡o thÃ nh má»™t cÃ¢y má»›i â‡’ $(u, v)$ $\in$ lÃ¡t cáº¯t $(S, G - S)$.
<blockquote>
<p><strong>Äá»‹nh nghÄ©a :</strong> Má»™t lÃ¡t cáº¯t $s$ - $t$ lÃ  má»™t táº­p con cá»§a ğ¸ mÃ  khi loáº¡i bá» nhá»¯ng cáº¡nh nÃ y thÃ¬ khÃ´ng cÃ²n Ä‘Æ°á»ng Ä‘i tá»« $s$ tá»›i $t$. (<a href="https://vnoi.info//wiki/translate/wcipeg/Flows#b%C3%A0i-to%C3%A1n-l%C3%A1t-c%E1%BA%AFt-h%E1%BA%B9p-nh%E1%BA%A5t-minimun-s-t-cut">BÃ i toÃ¡n lÃ¡t cáº¯t háº¹p nháº¥t</a>)</p>
</blockquote>
<p>Ta sáº½ chá»©ng minh $(u, v)$ thuá»™c <strong>lÃ¡t cáº¯t nhá» nháº¥t</strong> $(S, G - S)$</p>
<ul>
<li>Náº¿u tá»“n táº¡i Ä‘Æ°á»ng Ä‘i trá»ng sá»‘ $e$ tá»« $S$ Ä‘áº¿n $G - S$ cÃ³ trá»ng sá»‘ nhá» hÆ¡n $(u, v)$, thuáº­t toÃ¡n kruskal sáº½ chá»n $e$ thay vÃ¬ $(u, v)$ â‡’ vÃ´ lÃ½.
â‡’ <em>Ta kháº³ng Ä‘á»‹nh $(u, v)$ cÃ³ <strong>trá»ng sá»‘ nhá» nháº¥t</strong> trong cÃ¡c cáº¡nh tá»« $S$ Ä‘áº¿n $(G - S)$.</em> <strong>(1)</strong>
</li>
<li>Máº·t khÃ¡c, bá»Ÿi vÃ¬ $T^*$ lÃ  1 cÃ¢y khung nhá» nháº¥t nÃªn cÃ³ má»™t Ä‘Æ°á»ng tá»« $S$ tá»›i $G - S$, gá»i cáº¡nh thuá»™c Ä‘Æ°á»ng nÃ y lÃ  $(x, y)$. XÃ©t cÃ¢y khung :
${T^*}' = T^* \cup (u, v) - (x, y)$ â‡’ $c({T^*}') = c(T^*) + c(u, v) - c(x, y)$</li>
<li>Do theo <strong>(1)</strong> cÃ³: $c(u, v) â‰¤ c(x, y)$ nÃªn $c({T^*}') â‰¤ c(T^*)$ mÃ  $T^*$ lÃ  cÃ¢y khung nhá» nháº¥t â‡’ $c({T^*}')$ = $c(T^*)$ vÃ  ${T^*}'$ cÅ©ng lÃ  <strong>cÃ¢y khung nhá» nháº¥t</strong> â‡’ $|T - {T^*}'|$ = $|T - T^*| - 1$
<em><strong>Ã nghÄ©a :</strong> NhÆ° váº­y ta Ä‘Ã£ biáº¿n Ä‘á»•i Ä‘Æ°á»£c <strong>cÃ¢y khung nhá» nháº¥t</strong> ${T^*}$ thÃ nh cÃ¢y khung ${T^*}'$ cÅ©ng lÃ  <strong>cÃ¢y khung nhá» nháº¥t</strong> mÃ  lÃ m giáº£m sá»‘ cáº¡nh khÃ¡c nhau cá»§a $T$ vÃ  ${T^*}$ Ä‘i 1 cáº¡nh</em>
</li>
<li>Láº·p láº¡i cÃ¡ch chá»©ng minh vá»›i má»—i cáº¡nh thuá»™c $T - {T^*}'$, ta sáº½ biáº¿n Ä‘á»•i Ä‘Æ°á»£c ${T^*}'$ thÃ nh ${T}$, hay nÃ³i cÃ¡ch khÃ¡c Ä‘Ã£ Ä‘Ã£ biáº¿n Ä‘á»•i cÃ¢y khung nhá» nháº¥t ban Ä‘áº§u vá» cÃ¢y khung Ä‘áº§u ra cá»§a Kruskal : $c(T) = c(T^*)$.</li>
</ul>
</li>
</ul>
<p><strong>ÄÃ¡nh giÃ¡ Ä‘á»™ phá»©c táº¡p thuáº­t toÃ¡n:</strong>
Gá»i $n$ lÃ  sá»‘ Ä‘á»‰nh, $m$ lÃ  sá»‘ cáº¡nh cá»§a Ä‘á»“ thá»‹</p>
<p>Thuáº­t toÃ¡n gá»“m 2 pháº§n:</p>
<ul>
<li>Sáº¯p xáº¿p máº£ng $m$ cáº¡nh theo trá»ng sá»‘ tÄƒng dáº§n máº¥t Ä‘á»™ phá»©c táº¡p $O(m \log{m})$.</li>
<li>Ta duyá»‡t $m$ cáº¡nh, má»—i cáº¡nh dÃ¹ng Disjoint Set máº¥t Ä‘á»™ phá»©c táº¡p $O(\log{n})$, váº­y tá»•ng cá»™ng máº¥t Ä‘á»™ phá»©c táº¡p $O(m\log{n})$.</li>
</ul>
<p>$\Rightarrow$ Ä‘á»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n Kruskal lÃ  $O(m\log{m} +m\log{n})$</p>
<h3 class="editable"><a class="anchor" id="2-thuáº­t-toÃ¡n-prim" href="#2-thuáº­t-toÃ¡n-prim"></a>2. Thuáº­t toÃ¡n Prim</h3>
<p><strong>Ã tÆ°á»Ÿng thuáº­t toÃ¡n</strong>: Ã tÆ°á»Ÿng cá»§a thuáº­t toÃ¡n Prim ráº¥t giá»‘ng vá»›i Ã½ tÆ°á»Ÿng cá»§a thuáº­t toÃ¡n Dijkstra (tÃ¬m Ä‘Æ°á»ng Ä‘i ngáº¯n nháº¥t trÃªn Ä‘á»“ thá»‹).
Náº¿u nhÆ° thuáº­t toÃ¡n <strong>Kruskal</strong> xÃ¢y dá»±ng cÃ¢y khung nhá» nháº¥t báº±ng cÃ¡ch káº¿t náº¡p tá»«ng <strong>cáº¡nh</strong> vÃ o Ä‘á»“ thá»‹ thÃ¬ thuáº­t toÃ¡n <strong>Prim</strong> láº¡i káº¿t náº¡p tá»«ng <strong>Ä‘á»‰nh</strong> vÃ o Ä‘á»“ thá»‹ theo tiÃªu chÃ­: Ä‘á»‰nh Ä‘Æ°á»£c náº¡p vÃ o tiáº¿p theo pháº£i <strong>chÆ°a Ä‘Æ°á»£c náº¡p</strong> vÃ  <strong>gáº§n nháº¥t</strong> vá»›i cÃ¡c Ä‘á»‰nh Ä‘Ã£ Ä‘Æ°á»£c náº¡p vÃ o Ä‘á»“ thá»‹.</p>
<p>Thuáº­t toÃ¡n bao gá»“m cÃ¡c bÆ°á»›c sau:</p>
<ul>
<li>Khá»Ÿi táº¡o táº­p $S$ lÃ  cÃ¢y khung hiá»‡n táº¡i, ban Ä‘áº§u <strong>S</strong> chÆ°a cÃ³ Ä‘á»‰nh nÃ o.</li>
<li>Khá»Ÿi táº¡o máº£ng $D$ trong Ä‘Ã³ $D_i$ lÃ  khoáº£ng cÃ¡ch ngáº¯n nháº¥t tá»« Ä‘á»‰nh $i$ Ä‘áº¿n 1 Ä‘á»‰nh Ä‘Ã£ Ä‘Æ°á»£c káº¿t náº¡p vÃ o táº­p $S$, ban Ä‘áº§u $D[i]$ = $+\infty$</li>
<li>Láº·p láº¡i cÃ¡c thao tÃ¡c sau $n$ láº§n($n$ lÃ  sá»‘ cáº¡nh cá»§a Ä‘á»“ thá»‹)
<ul>
<li>TÃ¬m Ä‘á»‰nh $u$ khÃ´ng thuá»™c $S$ cÃ³ $D_u$ nhá» nháº¥t, thÃªm $u$ vÃ o táº­p $S$.</li>
<li>XÃ©t táº¥t cáº£ cÃ¡c Ä‘á»‰nh $v$ ká» $u$, cáº­p nháº­t $D_v = min(D_v, w_{u,v})$ vá»›i $w_{u,v}$ lÃ  trá»ng sá»‘ cáº¡nh $u-v$. Náº¿u $D_v$ Ä‘Æ°á»£c cáº­p nháº­t theo $w_{u,v}$ thÃ¬ Ä‘Ã¡nh dáº¥u $trace_v = u$.</li>
<li>ThÃªm cáº¡nh $u-trace[u]$ vÃ o táº­p cáº¡nh thuá»™c cÃ¢y khung nhá» nháº¥t.</li>
</ul>
</li>
</ul>
<p>Máº·c dÃ¹ khÃ´ng báº¯t buá»™c, cÃ¡c báº¡n cÃ³ thá»ƒ Ä‘á»c chá»©ng minh tÃ­nh Ä‘Ãºng Ä‘áº¯n thuáº­t toÃ¡n cá»§a Wiki táº¡i <a href="https://vi.wikipedia.org/wiki/Thu%E1%BA%ADt_to%C3%A1n_Prim#Ch%E1%BB%A9ng_minh">Ä‘Ã¢y</a>.</p>
<p>Khi hoÃ n thÃ nh xong $n$ bÆ°á»›c trÃªn, ta thu Ä‘Æ°á»£c cÃ¢y khung nhá» nháº¥t cá»§a Ä‘á»“ thá»‹ gá»“m $n$ Ä‘á»‰nh vÃ  $n - 1$ cáº¡nh.</p>
<p>VÃ­ dá»¥ cÃ¡c bÆ°á»›c giáº£i bÃ i toÃ¡n tÃ¬m cÃ¢y khung nhá» nháº¥t vá»›i thuáº­t toÃ¡n Prim:
<img src="https://i.imgur.com/E8xqn14.gif" /></p>
<p>Äoáº¡n code sá»­ dá»¥ng Ä‘á»ƒ cÃ i Ä‘áº·t thuáº­t toÃ¡n Prim:
</p><pre class="highlight"><code><span class="cm">/*input
4 4
1 2 1
2 3 2
3 4 3
4 1 4
*/</span>
<span class="cp">#include "bits/stdc++.h"
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="cp">#define fi first
#define se second
</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">INF</span> <span class="o">=</span> <span class="mf">1e9</span><span class="p">;</span>

<span class="c1">// khai bÃ¡o Ä‘á»“ thá»‹. g[u] chá»©a cÃ¡c cáº¡nh ná»‘i vá»›i Ä‘á»‰nh u. CÃ¡c cáº¡nh sáº½ Ä‘Æ°á»£c lÆ°u dÆ°á»›i dáº¡ng pair&lt;v,c&gt;</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
<span class="n">vector</span> <span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>

<span class="kt">int</span> <span class="n">dis</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">// máº£ng d lÆ°u khoáº£ng cÃ¡ch cá»§a toÃ n bá»™ Ä‘á»‰nh</span>

<span class="kt">int</span> <span class="nf">prim</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// thuáº­t toÃ¡n Prim báº¯t Ä‘áº§u cháº¡y tá»« Ä‘á»‰nh nguá»“n s</span>
    <span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="c1">// Sá»­ dá»¥ng priority_queue lÆ°u khoáº£ng cÃ¡ch cá»§a cÃ¡c Ä‘á»‰nh tÄƒng dáº§n Ä‘á»‘i vá»›i cÃ¢y khung</span>
    <span class="c1">// VÃ¬ priority_queue.top luÃ´n lÃ  pháº§n tá»­ lá»›n nháº¥t, ta sáº½ pháº£i sá»­ dá»¥ng greater&lt;pair&lt;int,int&gt;&gt;</span>
    <span class="c1">// Ä‘á»ƒ priority_queue.top lÃ  pháº§n tá»­ nhá» nháº¥t</span>
    <span class="c1">// cÃ¡c pháº§n tá»­ lÆ°u trong priority queue sáº½ cÃ³ dáº¡ng pair&lt;dis[u],u&gt;</span>
    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="p">,</span> <span class="n">greater</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>

    <span class="c1">// khá»Ÿi táº¡o khoáº£ng cÃ¡ch cá»§a cÃ¡c Ä‘á»‰nh lÃ  vÃ´ cÃ¹ng lá»›n</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">dis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>

    <span class="c1">// khá»Ÿi táº¡o Ä‘á»‰nh nguá»“n cÃ³ khoáº£ng cÃ¡ch lÃ  0 vÃ  push Ä‘á»‰nh nÃ y vÃ o</span>
    <span class="n">dis</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">});</span>

    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
        <span class="c1">// láº¥y Ä‘á»‰nh cÃ³ khoáº£ng cÃ¡ch nhá» nháº¥t chÆ°a Ä‘Æ°á»£c káº¿t náº¡p</span>
        <span class="k">auto</span> <span class="n">top</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">top</span><span class="p">();</span> <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="kt">int</span> <span class="n">curDis</span> <span class="o">=</span> <span class="n">top</span><span class="p">.</span><span class="n">fi</span><span class="p">;</span> <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">top</span><span class="p">.</span><span class="n">se</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">curDis</span> <span class="o">!=</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="k">continue</span><span class="p">;</span>

        <span class="c1">// káº¿t náº¡p Ä‘á»‰nh u vÃ o cÃ¢y khung</span>
        <span class="n">ret</span> <span class="o">+=</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">INF</span><span class="p">;</span>

        <span class="c1">// cáº­p nháº¥t khoáº£ng cÃ¡ch cho cÃ¡c Ä‘á»‰nh ká» u</span>
        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">fi</span><span class="p">;</span> <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">se</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
                <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span> <span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">v</span><span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">});</span>
        <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span> <span class="n">c</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">prim</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span></code></pre>
ÄÃ¡nh giÃ¡ Ä‘á»™ phá»©c táº¡p thuáº­t toÃ¡n:
<ul>
<li>Ta duyá»‡t tá»•ng cá»™ng $n$ láº§n, má»—i láº§n láº¥y 1 Ä‘á»‰nh ra khá»i heap máº¥t $O(\log{n})$ vÃ  cáº­p nháº­t trá»ng sá»‘ cá»§a táº¥t cáº£ cÃ¡c Ä‘á»‰nh ká» vá»›i Ä‘á»‰nh Ä‘Ã³, tá»•ng sá»‘ láº§n cáº­p nháº­t lÃ  $m$ láº§n, má»—i láº§n cáº­p nháº­t ta máº¥t Ä‘á»™ phá»©c táº¡p $O(\log{n})$.</li>
<li>NhÆ° váº­y, Ä‘á»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n Prim lÃ  $O((m + n)\log{n})$ vá»›i n lÃ  sá»‘ Ä‘á»‰nh vÃ  m lÃ  sá»‘ cáº¡nh cá»§a Ä‘á»“ thá»‹.</li>
</ul>
<p><strong>Fact</strong>: Trong cÃ¡c bÃ i toÃ¡n tÃ¬m cÃ¢y khung, pháº§n lá»›n má»i ngÆ°á»i sáº½ sá»­ dá»¥ng thuáº­t toÃ¡n <strong>Kruskal</strong> do tÃ­nh dá»… cÃ i Ä‘áº·t cÅ©ng nhÆ° dá»… hiá»ƒu cá»§a nÃ³.</p>
<blockquote>
<p><strong>Bonus :</strong> CÃ¡c báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng <a href="https://visualgo.net/en/mst">Visualgo</a> Ä‘á»ƒ mÃ´ phá»ng thuáº­t toÃ¡n Kruskal vÃ  Prim thÃ´ng qua hoáº¡t áº£nh, qua Ä‘Ã³ hiá»ƒu thÃªm vá» cÃ¡c thuáº­t toÃ¡n trÃªn</p>
</blockquote>
<h2 class="editable"><a class="anchor" id="má»™t-sá»‘-bÃ i-toÃ¡n-Ã¡p-dá»¥ng" href="#má»™t-sá»‘-bÃ i-toÃ¡n-Ã¡p-dá»¥ng"></a>Má»™t sá»‘ bÃ i toÃ¡n Ã¡p dá»¥ng</h2>
<h3 class="editable"><a class="anchor" id="1-bÃ i-toÃ¡n-nkcity" href="#1-bÃ i-toÃ¡n-nkcity"></a>1. BÃ i toÃ¡n <a href="https://oj.vnoi.info/problem/nkcity">NKCITY</a>
</h3>
<h4 class="editable"><a class="anchor" id="tÃ³m-táº¯t-Ä‘á»-bÃ i" href="#tÃ³m-táº¯t-Ä‘á»-bÃ i"></a>TÃ³m táº¯t Ä‘á» bÃ i</h4>
<p>1 thÃ nh phá»‘ gá»“m $N$ trá»ng Ä‘iá»ƒm, $M$ tuyáº¿n Ä‘Æ°á»ng cÃ³ thá»ƒ Ä‘Æ°á»£c xÃ¢y dá»±ng vá»›i chi phÃ­ xÃ¢y dá»±ng khÃ¡c nhau. YÃªu cáº§u chá»n ra má»™t sá»‘ tuyáº¿n Ä‘Æ°á»ng sao cho $N$ trá»ng Ä‘iá»ƒm pháº£i Ä‘Æ°á»£c liÃªn thÃ´ng vá»›i nhau vÃ  chi phÃ­ xÃ¢y dá»±ng tuyáº¿n Ä‘Æ°á»ng lá»›n nháº¥t lÃ  nhá» nháº¥t cÃ³ thá»ƒ.</p>
<h4 class="editable"><a class="anchor" id="thuáº­t-toÃ¡n" href="#thuáº­t-toÃ¡n"></a>Thuáº­t toÃ¡n</h4>
<p>Dá»±a vÃ o tÃ­nh cháº¥t <strong>Ä‘Æ°á»ng Ä‘i háº¹p nháº¥t</strong> cá»§a cÃ¢y khung mÃ  ta Ä‘Ã£ trÃ¬nh bÃ y á»Ÿ trÃªn, Ä‘Æ°á»ng Ä‘i giá»¯a 2 Ä‘á»‰nh $u$, $v$ báº¥t ká»³ trÃªn cÃ¢y khung nhá» nháº¥t lÃ  Ä‘Æ°á»ng Ä‘i cÃ³ cáº¡nh lá»›n nháº¥t lÃ  nhá» nháº¥t cá»§a Ä‘á»“ thá»‹.
NhÆ° váº­y viá»‡c chá»n ra cÃ¡c tuyáº¿n Ä‘Æ°á»ng Ä‘á»ƒ xÃ¢y dá»±ng chá»‰ Ä‘Æ¡n giáº£n lÃ  chá»n cÃ¡c cáº¡nh trÃªn cÃ¢y khung nhá» nháº¥t cá»§a Ä‘á»“ thá»‹.</p>
<h4 class="editable"><a class="anchor" id="Ä‘á»™-phá»©c-táº¡p" href="#Ä‘á»™-phá»©c-táº¡p"></a>Äá»™ phá»©c táº¡p</h4>
<p>ChÃ­nh lÃ  Ä‘á»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n tÃ¬m cÃ¢y khung nhá» nháº¥t mÃ  cÃ¡c báº¡n sáº½ cÃ i Ä‘áº·t.</p>
<h4 class="editable"><a class="anchor" id="cÃ i-Ä‘áº·t" href="#cÃ i-Ä‘áº·t"></a>CÃ i Ä‘áº·t</h4>
<p>á» Ä‘Ã¢y ta sáº½ dÃ¹ng Kruskal Ä‘á»ƒ tÃ¬m cÃ¢y khung nhá» nháº¥t
</p><pre class="highlight"><code><span class="cm">/*input
4 4
1 2 1
2 3 2
3 4 3
4 1 4
*/</span>
<span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">struct</span> <span class="nc">Edge</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
    <span class="n">Edge</span><span class="p">(</span><span class="kt">int</span> <span class="n">_u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_c</span><span class="p">)</span><span class="o">:</span> <span class="n">u</span><span class="p">(</span><span class="n">_u</span><span class="p">),</span> <span class="n">v</span><span class="p">(</span><span class="n">_v</span><span class="p">),</span> <span class="n">c</span><span class="p">(</span><span class="n">_c</span><span class="p">)</span> <span class="p">{};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">Dsu</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">par</span><span class="p">;</span>

    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">par</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="n">u</span><span class="p">)</span> <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="n">join</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span> <span class="n">v</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="n">dsu</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">maxWeight</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">vector</span> <span class="o">&lt;</span> <span class="n">Edge</span> <span class="o">&gt;</span> <span class="n">edges</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">edges</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="n">dsu</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

    <span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">edges</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="p">[](</span><span class="n">Edge</span> <span class="o">&amp;</span> <span class="n">x</span><span class="p">,</span> <span class="n">Edge</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">.</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">e</span> <span class="o">:</span> <span class="n">edges</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dsu</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
        <span class="n">maxWeight</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">maxWeight</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">maxWeight</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span></code></pre>
<h3 class="editable"><a class="anchor" id="2-bÃ i-toÃ¡n-tÃ¬m-cÃ¢y-khung-nhá»-nháº¥t-cho-má»—i-cáº¡nh-codeforces-609e" href="#2-bÃ i-toÃ¡n-tÃ¬m-cÃ¢y-khung-nhá»-nháº¥t-cho-má»—i-cáº¡nh-codeforces-609e"></a>2. BÃ i toÃ¡n <a href="https://codeforces.com/contest/609/problem/E">tÃ¬m cÃ¢y khung nhá» nháº¥t cho má»—i cáº¡nh - Codeforces 609E</a>
</h3>
<h4 class="editable"><a class="anchor" id="tÃ³m-táº¯t-Ä‘á»-bÃ i-1" href="#tÃ³m-táº¯t-Ä‘á»-bÃ i-1"></a>TÃ³m táº¯t Ä‘á» bÃ i</h4>
<p>Cho Ä‘á»“ thá»‹ vÃ´ hÆ°á»›ng $G$ gá»“m $n$ Ä‘á»‰nh vÃ  $m$ cáº¡nh. YÃªu cáº§u vá»›i má»—i cáº¡nh trong Ä‘á»“ thá»‹, tÃ¬m cÃ¢y khung nhá» nháº¥t <strong>chá»©a cáº¡nh Ä‘Ã³</strong> cá»§a Ä‘á»“ thá»‹ vÃ  in ra trá»ng sá»‘ cá»§a cÃ¢y khung Ä‘Ã³.</p>
<p>ÄÃ¢y lÃ  1 bÃ i táº­p khÃ¡ kinh Ä‘iá»ƒn vá» cÃ¢y khung nhá» nháº¥t. Äá»ƒ giáº£i Ä‘Æ°á»£c bÃ i táº­p nÃ y, chÃºng ta cáº§n giáº£i bÃ i LUBENICA trÆ°á»›c. CÃ¡c báº¡n cÃ³ thá»ƒ Ä‘á»c thÃªm vá» bÃ i á»Ÿ <a href="lubenica-vnoj">Ä‘Ã¢y</a></p>
<h4 class="editable"><a class="anchor" id="thuáº­t-toÃ¡n-1" href="#thuáº­t-toÃ¡n-1"></a>Thuáº­t toÃ¡n:</h4>
<ul>
<li>Äáº§u tiÃªn, ta dá»±ng cÃ¢y khung nhá» nháº¥t $S$ cá»§a Ä‘á»“ thá»‹ ban Ä‘áº§u:</li>
<li>Sau Ä‘Ã³, ta láº§n lÆ°á»£t Ä‘i tÃ¬m cÃ¢y khung nhá» nháº¥t chá»©a má»—i cáº¡nh cá»§a Ä‘á»“ thá»‹. Vá»›i 1 cáº¡nh i ná»‘i 2 Ä‘á»‰nh $u$, $v$ vá»›i trá»ng sá»‘ $w$, cÃ³ 2 trÆ°á»ng há»£p xáº£y ra:
<ul>
<li>Cáº¡nh $u-v$ Ä‘Ã£ thuá»™c cÃ¢y khung nhá» nháº¥t $S$ ban Ä‘áº§u, cÃ¢y khung cáº§n tÃ¬m chÃ­nh lÃ  $S$.</li>
<li>Cáº¡nh $u-v$ khÃ´ng thuá»™c cÃ¢y khung nhá» nháº¥t $S$. NhÆ° váº­y náº¿u thÃªm cáº¡nh $u-v$ vÃ o cÃ¢y khung sáº½ táº¡o thÃ nh chu trÃ¬nh tá»« $u\rightarrow v$. Do Ä‘Ã³ ta pháº£i xÃ³a Ä‘i 1 cáº¡nh trÃªn chu trÃ¬nh nÃ y Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh cháº¥t cá»§a cÃ¢y khung. VÃ  Ä‘Æ°Æ¡ng nhiÃªn Ä‘á»ƒ tá»‘i Æ°u thÃ¬ ta sáº½ chá»n xÃ³a Ä‘i cáº¡nh cÃ³ <strong>trá»ng sá»‘ lá»›n nháº¥t</strong> trÃªn Ä‘Æ°á»ng Ä‘i tá»« $u \rightarrow v$ (Ä‘Ã£ Ä‘Æ°á»£c trÃ¬nh bÃ y trong bÃ i LUBENICA á»Ÿ trÃªn) vÃ  thÃªm cáº¡nh $u-v$ vÃ o cÃ¢y khung sau khi Ä‘Ã£ xÃ³a cáº¡nh Ä‘Ã³.</li>
</ul>
</li>
</ul>
<h4 class="editable"><a class="anchor" id="code-máº«u" href="#code-máº«u"></a>Code máº«u:</h4>
<pre class="highlight"><code><span class="cm">/*input
8 10
8 7 11
3 5 23
2 1 23
7 2 13
6 4 18
1 4 20
8 4 17
2 8 8
3 2 9
5 6 29
*/</span>
<span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="cp">#define fi first
#define se second
#define bit(x, k) (1ll&amp;(x &gt;&gt; k))
</span>
<span class="k">using</span> <span class="n">ll</span> <span class="o">=</span> <span class="kt">long</span> <span class="kt">long</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">2e5</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">INF</span> <span class="o">=</span> <span class="mf">1e18</span><span class="p">;</span>

<span class="k">struct</span> <span class="nc">Edge</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">id</span><span class="p">;</span>
    <span class="n">Edge</span><span class="p">(</span><span class="kt">int</span> <span class="n">_u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_id</span><span class="p">)</span><span class="o">:</span> <span class="n">u</span><span class="p">(</span><span class="n">_u</span><span class="p">),</span> <span class="n">v</span><span class="p">(</span><span class="n">_v</span><span class="p">),</span> <span class="n">c</span><span class="p">(</span><span class="n">_c</span><span class="p">),</span> <span class="n">id</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span> <span class="p">{};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">Data</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">par</span><span class="p">;</span> <span class="n">ll</span> <span class="n">maxc</span> <span class="o">=</span> <span class="o">-</span><span class="n">INF</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">Dsu</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">par</span><span class="p">;</span>

    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">par</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="n">u</span><span class="p">)</span> <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="n">join</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span> <span class="n">v</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="n">dsu</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span> <span class="n">ll</span> <span class="n">mstWeight</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="n">ll</span> <span class="n">res</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="n">vector</span> <span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">edges</span><span class="p">;</span>
<span class="n">vector</span> <span class="o">&lt;</span><span class="n">pair</span> <span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="n">Data</span> <span class="n">up</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="mi">21</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">par</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">fi</span><span class="p">;</span> <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">se</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">==</span> <span class="n">p</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
        <span class="n">h</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">maxc</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// tÃ¬m cáº¡nh cÃ³ trá»ng sá»‘ lá»›n nháº¥t trÃªn Ä‘Æ°á»ng Ä‘i u, v nhÆ° bÃ i LUBENICA</span>
<span class="n">ll</span> <span class="nf">lca</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ll</span> <span class="n">ret</span> <span class="o">=</span> <span class="o">-</span><span class="n">INF</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">h</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">depth</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">-</span> <span class="n">h</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">bit</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">maxc</span><span class="p">);</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span><span class="p">)</span> <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span> <span class="o">!=</span> <span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">max</span><span class="p">({</span><span class="n">ret</span><span class="p">,</span> <span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">maxc</span><span class="p">,</span> <span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">maxc</span><span class="p">});</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span><span class="p">;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">max</span><span class="p">({</span><span class="n">ret</span><span class="p">,</span> <span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">maxc</span><span class="p">,</span> <span class="n">up</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">maxc</span><span class="p">});</span>
    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">buildMST</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">dsu</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">edges</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="p">[](</span><span class="n">Edge</span> <span class="o">&amp;</span> <span class="n">x</span><span class="p">,</span> <span class="n">Edge</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">.</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">:</span> <span class="n">edges</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dsu</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
        <span class="n">g</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">});</span>
        <span class="n">g</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">});</span>
        <span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="c1">// Ä‘Ã¡nh dáº¥u lÃ  cáº¡nh nÃ y thuá»™c cÃ¢y khung nhá» nháº¥t</span>
        <span class="n">mstWeight</span> <span class="o">+=</span> <span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">buildLCA</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">u</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">u</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">par</span> <span class="o">=</span> <span class="n">up</span><span class="p">[</span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">par</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">par</span><span class="p">;</span>
            <span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">maxc</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxc</span><span class="p">,</span> <span class="n">up</span><span class="p">[</span><span class="n">up</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">par</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">maxc</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">edges</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="c1">// dá»±ng cÃ¢y khung nhá» nháº¥t</span>
    <span class="n">buildMST</span><span class="p">();</span>

    <span class="c1">// dá»±ng LCA</span>
    <span class="n">buildLCA</span><span class="p">();</span>

    <span class="c1">// tÃ¬m cÃ¢y khung nhá» nháº¥t cho tá»«ng cáº¡nh</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">:</span> <span class="n">edges</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">mstWeight</span><span class="p">;</span>
        <span class="k">else</span> <span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">mstWeight</span> <span class="o">-</span> <span class="n">lca</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// in ra káº¿t quáº£</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre>
<h3 class="editable"><a class="anchor" id="3-bÃ i-toÃ¡n-160d-edges-in-mst" href="#3-bÃ i-toÃ¡n-160d-edges-in-mst"></a>3. BÃ i toÃ¡n <a href="https://codeforces.com/problemset/problem/160/D">160D - Edges in MST</a>
</h3>
<h4 class="editable"><a class="anchor" id="tÃ³m-táº¯t-Ä‘á»-bÃ i-2" href="#tÃ³m-táº¯t-Ä‘á»-bÃ i-2"></a>TÃ³m táº¯t Ä‘á» bÃ i</h4>
<p>Cho Ä‘á»“ thá»‹ vÃ´ hÆ°á»›ng cÃ³ trá»ng sá»‘ $G$ gá»“m $n$ Ä‘á»‰nh vÃ  $m$ cáº¡nh. YÃªu cáº§u vá»›i má»—i cáº¡nh trong Ä‘á»“ thá»‹, kiá»ƒm tra xem cáº¡nh Ä‘Ã³ <strong>khÃ´ng thuá»™c</strong> báº¥t ká»³ cÃ¢y khung nhá» nháº¥t nÃ o, thuá»™c <strong>má»™t sá»‘</strong> cÃ¢y khung nhá» nháº¥t hay náº±m trong <strong>má»i</strong> cÃ¢y khung nhá» nháº¥t cá»§a Ä‘á»“ thá»‹.</p>
<h4 class="editable"><a class="anchor" id="thuáº­t-toÃ¡n-2" href="#thuáº­t-toÃ¡n-2"></a>Thuáº­t toÃ¡n</h4>
<ul>
<li>Ban Ä‘áº§u, khá»Ÿi táº¡o Ä‘á»“ thá»‹ $G'$ rá»—ng. Ta sáº½ xÃ©t láº§n lÆ°á»£t tá»«ng nhÃ³m cÃ¡c cáº¡nh cÃ³ cÃ¹ng trá»ng sá»‘ vÃ  thÃªm chÃºng vÃ o Ä‘á»“ thá»‹ $G'$. Äá»“ng thá»i, vá»›i má»—i cáº¡nh ta khÃ´ng quan tÃ¢m nÃ³ ná»‘i 2 Ä‘á»‰nh nÃ o mÃ  chá»‰ quan tÃ¢m nÃ³ ná»‘i 2 <strong>TPLT</strong> nÃ o trong Ä‘á»“ thá»‹ hiá»‡n táº¡i.</li>
<li>Nháº­n xÃ©t ráº±ng náº¿u cÃ³ cáº¡nh káº¿t ná»‘i 2 <strong>TPLT khÃ¡c nhau</strong>, cÃ¡c cáº¡nh nÃ y sáº½ xuáº¥t hiá»‡n trong <strong>Ã­t nháº¥t</strong> 1 cÃ¢y khung nhá» nháº¥t. NgÆ°á»£c láº¡i, náº¿u 1 cáº¡nh ná»‘i 2 Ä‘á»‰nh <strong>Ä‘Ã£ liÃªn thÃ´ng</strong> tá»« trÆ°á»›c thÃ¬ cáº¡nh nÃ y sáº½ <strong>khÃ´ng thuá»™c</strong> báº¥t ká»³ cÃ¢y khung nhá» nháº¥t nÃ o.</li>
<li>XÃ©t cÃ¡c nhÃ³m cáº¡nh cÃ³ <strong>cÃ¹ng trá»ng sá»‘</strong> mÃ  thuá»™c <strong>2 thÃ nh pháº§n liÃªn thÃ´ng khÃ¡c nhau</strong>, ta dá»±ng Ä‘á»“ thá»‹ $G$ má»›i tá»« cÃ¡c nhÃ³m cáº¡nh Ä‘Ã³ vá»›i cÃ¡c Ä‘á»‰nh lÃ  cÃ¡c thÃ nh pháº§n liÃªn thÃ´ng.</li>
<li>
<strong>Dá»… tháº¥y</strong> : Chá»n táº­p cáº¡nh tá»« $G$ Ä‘á»ƒ thÃªm vÃ o cÃ¢y khung, táº­p cáº¡nh Ä‘Ã³ pháº£i thá»a mÃ£n khÃ´ng táº¡o ra chu trÃ¬nh vÃ  khÃ´ng lÃ m tÄƒng thÃ nh pháº§n liÃªn thÃ´ng cá»§a $G$ bá»Ÿi vÃ¬ :
<ul>
<li>Náº¿u táº­p cáº¡nh chá»n chá»©a chu trÃ¬nh thÃ¬ Ä‘áº§u ra khÃ´ng cÃ²n lÃ  cÃ¢y khung</li>
<li>Náº¿u táº­p cáº¡nh lÃ m tÄƒng sá»‘ lÆ°á»£ng thÃ nh pháº§n liÃªn thÃ´ng cá»§a $G$ thÃ¬ cÃ¢y khung sáº½ máº¥t tÃ­nh <strong>nhá» nháº¥t</strong>
</li>
</ul>
</li>
<li>Váº­y cáº¡nh náº±m trong <strong>má»i cÃ¢y khung</strong> sáº½ pháº£i lÃ  cáº¡nh mÃ  náº±m trong <strong>má»i táº­p cáº¡nh</strong> mÃ¬nh chá»n á»Ÿ trÃªn, náº¿u táº­p cáº¡nh thiáº¿u nÃ³ thÃ¬ vi pháº¡m tÃ­nh <strong>nhá» nháº¥t</strong>.
â‡’ CÃ³ nghÄ©a lÃ  náº¿u thiáº¿u cáº¡nh Ä‘Ã³ thÃ¬ sáº½ lÃ m tÄƒng <strong>thÃ nh pháº§n liÃªn thÃ´ng</strong> cá»§a $G$. Váº­y Ä‘Ã³ chá»‰ cÃ³ thá»ƒ lÃ  <strong>cáº¡nh cáº§u</strong>.</li>
<li>Káº¿t luáº­n :
<ul>
<li>CÃ¡c <strong>cáº¡nh cáº§u</strong> sáº½ náº±m trong <strong>má»i</strong> cÃ¢y khung nhá» nháº¥t cá»§a Ä‘á»“ thá»‹</li>
<li>CÃ¡c cáº¡nh cÃ²n láº¡i <strong>khÃ´ng pháº£i cáº¡nh cáº§u</strong> sáº½ thuá»™c <strong>má»™t sá»‘</strong> cÃ¢y khung nhá» nháº¥t</li>
<li>
<strong>Xem thÃªm</strong> : <a href="https://vnoi.info/wiki/algo/graph-theory/Depth-First-Search-Tree.md#t%C3%ACm-c%E1%BA%A1nh-c%E1%BA%A7u">TÃ¬m cáº¡nh cáº§u</a>
</li>
</ul>
</li>
</ul>
<h4 class="editable"><a class="anchor" id="Ä‘á»™-phá»©c-táº¡p-1" href="#Ä‘á»™-phá»©c-táº¡p-1"></a>Äá»™ phá»©c táº¡p</h4>
<ul>
<li>Äáº§u tiÃªn, ta pháº£i sáº¯p xáº¿p láº¡i cÃ¡c cáº¡nh theo trá»ng sá»‘ tÄƒng dáº§n máº¥t Ä‘pt $O(m\log{m})$. Sau Ä‘Ã³, ta pháº£i duy trÃ¬ 1 Ä‘á»“ thá»‹ hiá»‡n táº¡i trong quÃ¡ trÃ¬nh láº§n lÆ°á»£t thÃªm cÃ¡c nhÃ³m cáº¡nh vÃ o Ä‘á»“ thá»‹, á»Ÿ Ä‘Ã¢y ta sá»­ dá»¥ng <strong>Disjoint Set</strong> Ä‘á»ƒ kiá»ƒm tra 2 Ä‘á»‰nh ná»‘i 2 TPLT nÃ o cÅ©ng nhÆ° thÃªm cÃ¡c cáº¡nh vÃ o Ä‘á»“ thá»‹ hiá»‡n táº¡i.</li>
<li>Thuáº­t toÃ¡n <strong>Tarjan</strong> Ä‘á»ƒ tÃ¬m <strong>cáº§u</strong> cÃ³ Ä‘á»™ phá»©c táº¡p $O(m + n)$ cho toÃ n Ä‘á»“ thá»‹
â‡’ NhÆ° váº­y, Ä‘á»™ phá»©c táº¡p tá»•ng cá»§a bÃ i toÃ¡n lÃ  $O(m\log{m} + m\log{n} + n)$.</li>
</ul>
<h4 class="editable"><a class="anchor" id="cÃ i-Ä‘áº·t-1" href="#cÃ i-Ä‘áº·t-1"></a>CÃ i Ä‘áº·t</h4>
<pre class="highlight"><code><span class="cm">/*input
4 5
1 2 101
1 3 100
2 3 2
2 4 2
3 4 1
*/</span>
<span class="cp">#include "bits/stdc++.h"
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="cp">#define fi first
#define se second
</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">EdgeType</span> <span class="p">{</span>
    <span class="n">NONE</span><span class="p">,</span> <span class="c1">// khÃ´ng cÃ¢y nÃ o chá»©a</span>
    <span class="n">ANY</span><span class="p">,</span> <span class="c1">// táº¥t cáº£ cÃ¡c cÃ¢y Ä‘á»u chá»©a</span>
    <span class="n">ATL</span> <span class="c1">// Ã­t nháº¥t 1 cÃ¢y chá»©a</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">Edge</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">id</span><span class="p">;</span>
    <span class="n">Edge</span><span class="p">(</span><span class="kt">int</span> <span class="n">_u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_c</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_id</span><span class="p">)</span><span class="o">:</span> <span class="n">u</span><span class="p">(</span><span class="n">_u</span><span class="p">),</span> <span class="n">v</span><span class="p">(</span><span class="n">_v</span><span class="p">),</span> <span class="n">c</span><span class="p">(</span><span class="n">_c</span><span class="p">),</span> <span class="n">id</span><span class="p">(</span><span class="n">_id</span><span class="p">)</span> <span class="p">{};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">Dsu</span> <span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">par</span><span class="p">;</span>

    <span class="kt">void</span> <span class="n">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">par</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="n">u</span><span class="p">)</span> <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">par</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="n">join</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span> <span class="n">v</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
        <span class="n">par</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="n">dsu</span><span class="p">;</span>

<span class="n">vector</span> <span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">low</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">num</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">Time</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
<span class="n">EdgeType</span> <span class="n">res</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="n">vector</span> <span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">edges</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">idx</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">num</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="o">++</span><span class="n">Time</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">fi</span><span class="p">;</span> <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">se</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">id</span> <span class="o">==</span> <span class="n">idx</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
            <span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="p">{</span>
                <span class="c1">// náº¿u cáº¡nh lÃ  cáº§u thÃ¬ má»i cÃ¢y Ä‘á»u pháº£i chá»©a</span>
                <span class="n">res</span><span class="p">[</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">EdgeType</span><span class="o">::</span><span class="n">ANY</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">num</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">solve</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">pen</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// xá»­ lÃ½ cÃ¡c nhÃ³m cáº¡nh cÃ³ cÃ¹ng trá»ng sá»‘</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pen</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>

    <span class="c1">// khá»Ÿi táº¡o Ä‘á»“ thá»‹ ná»‘i cÃ¡c thÃ nh pháº§n liÃªn thÃ´ng</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">pen</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

        <span class="c1">// sá»­ dá»¥ng Ä‘á»‰nh cha trong dsu lÃ m Ä‘á»‰nh Ä‘áº¡i diá»‡n cho thÃ nh pháº§n liÃªn thÃ´ng</span>
        <span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">u</span> <span class="o">=</span> <span class="n">dsu</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">u</span><span class="p">);</span> <span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span> <span class="o">=</span> <span class="n">dsu</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">);</span>
        <span class="n">g</span><span class="p">[</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">u</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span> <span class="n">g</span><span class="p">[</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
        <span class="n">num</span><span class="p">[</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span><span class="p">[</span><span class="n">pen</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">e</span> <span class="o">:</span> <span class="n">pen</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span> <span class="o">==</span> <span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// náº¿u 2 Ä‘á»‰nh cÃ¹ng thuá»™c 1 thÃ nh pháº§n liÃªn thÃ´ng</span>
            <span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">EdgeType</span><span class="o">::</span><span class="n">NONE</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// náº¿u 2 Ä‘á»‰nh ná»‘i 2 thÃ nh pháº§n liÃªn thÃ´ng khÃ¡c nhau láº¡i vá»›i nhau</span>
            <span class="n">res</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">EdgeType</span><span class="o">::</span><span class="n">ATL</span><span class="p">;</span>
            <span class="c1">// thÃªm cáº¡nh vÃ o Ä‘á»“ thá»‹</span>
            <span class="n">g</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">});</span>
            <span class="n">g</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">id</span><span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// tÃ¬m cáº¡nh cáº§u</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">:</span> <span class="n">pen</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">num</span><span class="p">[</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">dfs</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="c1">// sau khi hoÃ n thÃ nh, ta thá»±c hiá»‡n há»£p cÃ¡c cáº¡nh vÃ o cÃ¢y khung</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">:</span> <span class="n">pen</span><span class="p">)</span> <span class="n">dsu</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">u</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">v</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">;</span>
        <span class="n">edges</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="n">dsu</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

    <span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">edges</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="p">[](</span><span class="n">Edge</span> <span class="n">x</span><span class="p">,</span> <span class="n">Edge</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">.</span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">.</span><span class="n">c</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">pen</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">e</span> <span class="o">:</span> <span class="n">edges</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pen</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">pen</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">c</span> <span class="o">==</span> <span class="n">e</span><span class="p">.</span><span class="n">c</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">pen</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="n">solve</span><span class="p">(</span><span class="n">pen</span><span class="p">);</span>
            <span class="n">pen</span> <span class="o">=</span> <span class="p">{</span><span class="n">e</span><span class="p">};</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">solve</span><span class="p">(</span><span class="n">pen</span><span class="p">);</span>

    <span class="c1">// in ra káº¿t quáº£</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">EdgeType</span><span class="o">::</span><span class="n">NONE</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"none</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">EdgeType</span><span class="o">::</span><span class="n">ANY</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"any</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="k">else</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"at least one</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
<h2 class="editable"><a class="anchor" id="luyá»‡n-táº­p" href="#luyá»‡n-táº­p"></a>Luyá»‡n táº­p</h2>
<p>CÃ¡c báº¡n cÃ³ thá»ƒ thá»­ sá»©c vá»›i má»™t sá»‘ bÃ i táº­p sau:</p>
<ul>
<li>
<a href="https://www.spoj.com/PTIT/problems/P186SUMF/">P186SUMF</a> - <a href="https://codeforces.com/problemset/problem/959/E">959E</a>
</li>
<li><a href="https://vn.spoj.com/problems/VMST/">VMST</a></li>
<li><a href="https://codeforces.com/group/FLVn1Sc504/contest/274809/problem/B">C11WATER</a></li>
<li><a href="https://codeforces.com/group/FLVn1Sc504/contest/274809/problem/M">CHEER</a></li>
</ul>
</div>
</div>
</div>
</div>
