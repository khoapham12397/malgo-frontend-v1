<div id="wiki-content">
<h1 class="pt-4">HÃ ng Ä‘á»£i hai Ä‘áº§u (deque) vÃ  BÃ i toÃ¡n tÃ¬m max-min trong Ä‘oáº¡n tá»‹nh tiáº¿n</h1>
<div class="breadcrumb"><nav aria-label="Breadcrumb"><ol>
<li class="breadcrumb-item"><a href="https://vnoi.info/wiki/gollum/overview/algo/">algo</a></li>
<li class="breadcrumb-item"><a href="https://vnoi.info/wiki/gollum/overview/algo/data-structures/">data-structures</a></li>
</ol></nav></div>
<div class>
<div id="wiki-body" class="gollum-markdown-content overflow-hidden ">
<div class="markdown-body ">
<p><strong>TÃ¡c giáº£:</strong></p>
<ul>
<li>
<strong>BÃ¹i Minh Hoáº¡t</strong> - Hung Vuong High School for the Gifted, Phu Tho Province</li>
<li>
<strong>Nguyá»…n ChÃ¢u Khanh</strong> - Hung Vuong High School for the Gifted, Phu Tho Province</li>
</ul>
<p><strong>Reviewer:</strong> <strong>Pháº¡m Tuáº¥n NghÄ©a</strong></p>
<p></p><div class="toc"><div class="toc-title">Table of Contents</div><ul><li><a href="#Ä‘á»‹nh-nghÄ©a">Äá»‹nh nghÄ©a</a></li><li><a href="#bÃ i-toÃ¡n-1">BÃ i toÃ¡n 1</a><ul><li><a href="#phÃ¢n-tÃ­ch">PhÃ¢n tÃ­ch</a></li><li><a href="#cÃ i-Ä‘áº·t">CÃ i Ä‘áº·t</a></li><li><a href="#Ä‘Ã¡nh-giÃ¡">ÄÃ¡nh giÃ¡</a></li><li><a href="#má»Ÿ-rá»™ng">Má»Ÿ rá»™ng</a><ul><li><a href="#tÃ¬m-giÃ¡-trá»‹-lá»›n-nháº¥t">TÃ¬m giÃ¡ trá»‹ lá»›n nháº¥t</a></li><li><a href="#táº¡i-sao-ta-khÃ´ng-nÃªn-sá»­-dá»¥ng-cáº¥u-trÃºc-dá»¯-liá»‡u-cÃ¢y-phÃ¢n-Ä‘oáº¡n">Táº¡i sao ta khÃ´ng nÃªn sá»­ dá»¥ng cáº¥u trÃºc dá»¯ liá»‡u cÃ¢y phÃ¢n Ä‘oáº¡n?</a></li><li><a href="#khi-nÃ o-thÃ¬-khÃ´ng-thá»ƒ-dÃ¹ng-deque-Ä‘á»ƒ-tÃ¬m-max-min-trong-Ä‘oáº¡n-tá»‹nh-tiáº¿n">Khi nÃ o thÃ¬ khÃ´ng thá»ƒ dÃ¹ng deque Ä‘á»ƒ tÃ¬m max min trong Ä‘oáº¡n tá»‹nh tiáº¿n?</a></li></ul></li><li><a href="#má»™t-sá»‘-lá»—i-thÆ°á»ng-gáº·p">Má»™t sá»‘ lá»—i thÆ°á»ng gáº·p</a></li></ul></li><li><a href="#bÃ i-toÃ¡n-2">BÃ i toÃ¡n 2</a><ul><li><a href="#Ä‘á»-bÃ i">Äá» bÃ i</a></li><li><a href="#phÃ¢n-tÃ­ch-1">PhÃ¢n tÃ­ch</a></li><li><a href="#cÃ i-Ä‘áº·t-1">CÃ i Ä‘áº·t</a></li></ul></li><li><a href="#bÃ i-toÃ¡n-3">BÃ i toÃ¡n 3</a><ul><li><a href="#Ä‘á»-bÃ i-1">Äá» bÃ i</a></li><li><a href="#phÃ¢n-tÃ­ch-2">PhÃ¢n tÃ­ch</a></li><li><a href="#cÃ i-Ä‘áº·t-2">CÃ i Ä‘áº·t</a></li><li><a href="#Ä‘Ã¡nh-giÃ¡-1">ÄÃ¡nh giÃ¡</a></li></ul></li><li><a href="#bÃ i-táº­p-Ã¡p-dá»¥ng">BÃ i táº­p Ã¡p dá»¥ng</a></li></ul></div>
<h1 class="editable"><a class="anchor" id="Ä‘á»‹nh-nghÄ©a" href="#Ä‘á»‹nh-nghÄ©a"></a><strong>Äá»‹nh nghÄ©a</strong></h1>
<p>Deque (Double-ended queue) lÃ  má»™t kiá»ƒu dá»¯ liá»‡u trá»«u tÆ°á»£ng tá»•ng quÃ¡t hÃ³a má»™t hÃ ng Ä‘á»£i. NÃ³ lÃ  nÃ³ kiá»ƒu danh sÃ¡ch mÃ  cÃ³ thá»ƒ bá»• sung vÃ  loáº¡i bá» má»™t pháº§n á»Ÿ Ä‘áº§u hoáº·c cuá»‘i danh sÃ¡ch.
<img src="https://i.imgur.com/0f5hQR9.png" /></p>
<p><strong>CÃ¡c thao tÃ¡c deque há»— trá»£:</strong></p>
<ul>
<li>push_front($x$): Äáº©y $x$ vÃ o Ä‘áº§u deque</li>
<li>push_back($ğ‘¥$): Äáº©y $x$ vÃ o cuá»‘i deque</li>
<li>pop_front(): Loáº¡i bá» pháº§n tá»­ á»Ÿ Ä‘áº§u deque</li>
<li>pop_back(): Loáº¡i bá» pháº§n tá»­ á»Ÿ cuá»‘i deque</li>
<li>empty(): Kiá»ƒm tra Deque cÃ³ rá»—ng khÃ´ng?</li>
<li>size(): Tráº£ vá» sá»‘ pháº§n tá»­ Ä‘ang cÃ³ trong deque</li>
</ul>
<p><strong>Äá»™ phá»©c táº¡p:</strong></p>
<ul>
<li>Äá»™ phá»©c táº¡p thá»i gian cá»§a táº¥t cáº£ cÃ¡c hoáº¡t Ä‘á»™ng trong deque lÃ  $O(1)$</li>
<li>Äá»™ phá»©c táº¡p thá»i gian cá»§a truy cáº­p ngáº«u nhiÃªn theo chá»‰ má»¥c lÃ  $O(n)$</li>
</ul>
<h1 class="editable"><a class="anchor" id="bÃ i-toÃ¡n-1" href="#bÃ i-toÃ¡n-1"></a><strong>BÃ i toÃ¡n 1</strong></h1>
<p>Cho má»™t dÃ£y $A$ gá»“m $N$ pháº§n tá»­ Ä‘Æ°á»£c Ä‘Ã¡nh sá»‘ tá»« 1 Ä‘áº¿n $N$. Pháº§n tá»­ thá»© $i$ cÃ³ giÃ¡ trá»‹ lÃ  $A[i]$. Cho $k$ lÃ  má»™t sá»‘ nguyÃªn dÆ°Æ¡ng ($k â‰¤ N$). Vá»›i má»—i pháº§n tá»­ $i$ ($k â‰¤ i â‰¤ N$), tÃ¬m giÃ¡ trá»‹ nhá» nháº¥t cá»§a cÃ¡c pháº§n tá»­ trong Ä‘oáº¡n tá»« $i â€“ k + 1$ Ä‘áº¿n $i$ trÃªn dÃ£y $A$.
$minRange[i] =$ giÃ¡ trá»‹ nhá» nháº¥t trong Ä‘oáº¡n $[i - k + 1 â€¦ i]$</p>
<p><strong>Input:</strong></p>
<ul>
<li>$DÃ²ng$ $1$: chá»©a hai sá»‘ nguyÃªn dÆ°Æ¡ng $N \le 10^5 , ğ‘˜ \le N$ cÃ¡ch nhau bá»Ÿi dáº¥u cÃ¡ch</li>
<li>$DÃ²ng$ $2$: chá»©a $N$ sá»‘ nguyÃªn dÆ°Æ¡ng $A_1, A_2, â€¦ , A_N$ $(âˆ€ğ‘–: A_ğ‘– â‰¤ 10^9)$ cÃ¡ch nhau bá»Ÿi dáº¥u cÃ¡ch</li>
</ul>
<p><strong>Output:</strong> In ra $N âˆ’ ğ‘˜ + 1$ dÃ²ng:</p>
<ul>
<li>DÃ²ng thá»© $i$ in ra giÃ¡ trá»‹ nhá» nháº¥t $minRange[i]$ cá»§a cÃ¡c pháº§n tá»­ trong Ä‘oáº¡n tá»« $i - k + 1$ Ä‘áº¿n $i$.</li>
</ul>
<p><strong>VÃ­ dá»¥:</strong></p>
<p><strong>Input</strong>
</p><pre class="highlight"><code>8 4 
1 3 5 7 4 5 9 5</code></pre>
<p><strong>Output</strong>
</p><pre class="highlight"><code>1
3
4
4
4</code></pre>
<h2 class="editable"><a class="anchor" id="phÃ¢n-tÃ­ch" href="#phÃ¢n-tÃ­ch"></a><strong>PhÃ¢n tÃ­ch</strong></h2>
<p>Vá»›i bÃ i toÃ¡n nÃ y ta cÃ³ thá»ƒ duyá»‡t táº¥t cáº£ cÃ¡c Ä‘oáº¡n gá»“m $k$ pháº§n tá»­ liÃªn tiáº¿p trong máº£ng $A$ Ä‘á»ƒ tÃ¬m giÃ¡ trá»‹ nhá» nháº¥t.
<img src="https://i.imgur.com/nI9T8t3.png" /></p>
<pre class="highlight"><code><span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">105</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span>  <span class="n">INF</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">K</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">minRange</span> <span class="o">=</span> <span class="o">+</span><span class="n">INF</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">K</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="o">--</span><span class="n">j</span><span class="p">)</span>
        <span class="n">minRange</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">minRange</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">minRange</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span></code></pre>
<p>Tuy nhiÃªn cÃ¡ch lÃ m nÃ y khÃ´ng Ä‘em láº¡i hiá»‡u quáº£ cao. <strong>Äá»™ phá»©c táº¡p:</strong> $O(k \cdot (N - k))$</p>
<p>Má»—i láº§n gÃ¡n $minRange = min(minRange, A[j])$ thÃ¬ máº¥u chá»‘t lÃ  nhá»¯ng vá»‹ trÃ­ mÃ  $minRange$ thay Ä‘á»•i. Váº­y nÃªn ta sáº½ chá»‰ lÆ°u láº¡i nhá»¯ng vá»‹ trÃ­ cÃ³ thá»ƒ lÃ m thay Ä‘á»•i $minRange$. Ta tháº¥y ráº±ng cÃ¡c vá»‹ trÃ­ lÆ°u vÃ o tÄƒng dáº§n vá» cáº£ giÃ¡ trá»‹ cÅ©ng nhÆ° vá»‹ trÃ­.</p>
<p><strong>Minh há»a</strong></p>
<p><img src="https://i.imgur.com/ECBlewQ.png" /></p>
<p>CÃ¡c Ã´ Ä‘Æ°á»£c tÃ´ mÃ u Ä‘á» lÃ  cÃ¡c Ã´ lÃ m thay Ä‘á»•i giÃ¡ trá»‹ $minRange$. Ã” thá»© $2$ cÃ³ giÃ¡ trá»‹ $A[2] = 2$ ta khÃ´ng cáº§n quan tÃ¢m vÃ¬ ngay tá»« $A[3] = 2$ nÃ³ Ä‘Ã£ khÃ´ng náº±m trong danh sÃ¡ch cÃ¡c Ã´ mÃ u Ä‘á».</p>
<p><img src="https://i.imgur.com/MpAwBtt.png" /></p>
<p>TÆ°Æ¡ng tá»±, Ä‘á»‘i vá»›i Ä‘oáº¡n $[2 â€¦ 5]$ ta cÅ©ng khÃ´ng cáº§n quan tÃ¢m Ä‘áº¿n Ã´ thá»© $2$ cÃ³ giÃ¡ trá»‹ $A[2] = 2$.
Do Ä‘Ã³ ta cÃ³ thá»ƒ lÃ m nhÆ° sau:</p>
<p><strong>TÃ¬m giÃ¡ trá»‹ nhá» nháº¥t</strong></p>
<p><strong>Minh há»a test:</strong> Cho $N$ $=$ $8$, $K$ $=$ $4$, dÃ£y $A$ $=$ $[1, 3, 5, 7, 4, 5, 9, 5]$</p>
<p>Äáº§u tiÃªn chÃºng ta khá»Ÿi táº¡o má»™t hÃ ng Ä‘á»£i hai Ä‘áº§u nháº±m má»¥c Ä‘Ã­ch lÆ°u vá»‹ trÃ­ cá»§a pháº§n tá»­ cÃ³ giÃ¡ trá»‹ nhá» nháº¥t.</p>
<p>LÃºc Ä‘áº§u hÃ ng Ä‘á»£i hai Ä‘áº§u cá»§a chÃºng ta rá»—ng
<img src="https://i.imgur.com/2SI3P7o.png" />
Äá»‘i vá»›i pháº§n tá»­ Ä‘áº§u tiÃªn vÃ¬ do hÃ ng Ä‘á»£i rá»—ng nÃªn ta sáº½ Ä‘áº©y pháº§n tá»­ nÃ y vÃ o cuá»‘i hÃ ng Ä‘á»£i
<img src="https://i.imgur.com/AiuYFLJ.png" />
Tiáº¿p theo ta sáº½ Ä‘áº©y láº§n lÆ°á»£t cÃ¡c pháº§n tá»­ cÃ³ vá»‹ trÃ­ $2$$;$ $3$ vÃ  $4$ vÃ o cuá»‘i hÃ ng Ä‘á»£i.
<img src="https://i.imgur.com/w3AlnmP.png" />
VÃ¬ ta chá»‰ xÃ©t cÃ¡c Ä‘oáº¡n trong khoáº£ng tá»« $[i - k + 1 â€¦ i]$. Do Ä‘Ã³ khi ta xÃ©t Ä‘áº¿n pháº§n tá»­ thá»© $5$ thÃ¬ pháº§n tá»­ Ä‘áº§u tiÃªn trong hÃ ng Ä‘á»£i cÃ³ vá»‹ trÃ­ $i = 1$ khÃ´ng cÃ²n Ã½ nghÄ©a gÃ¬ ná»¯a. VÃ¬ váº­y ta sáº½ loáº¡i bá» pháº§n tá»­ Ä‘áº§u tiÃªn ra khá»i hÃ ng Ä‘á»£i.
Khi ta loáº¡i bá» pháº§n tá»­ Ä‘áº§u tiÃªn ra khá»i hÃ ng Ä‘á»£i thÃ¬ táº¥t cáº£ cÃ¡c pháº§n tá»­ Ä‘á»©ng sau pháº§n tá»­ Ä‘Ã³ Ä‘á»ƒ Ä‘Æ°á»£c Ä‘áº©y lÃªn $1$ Ã´ vÃ  hÃ ng Ä‘á»£i sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh sá»‘ láº¡i.
<img src="https://i.imgur.com/YsFpJBy.png" /></p>
<p>Tiáº¿p Ä‘áº¿n khi ta chuáº©n bá»‹ Ä‘áº©y pháº§n tá»­ thá»© $5$ vÃ o hÃ ng Ä‘á»£i thÃ¬ nháº­n tháº¥y ráº±ng giÃ¡ trá»‹ cá»§a nÃ³ nhá» hÆ¡n giÃ¡ trá»‹ cá»§a pháº§n tá»­ cuá»‘i trong hÃ ng Ä‘á»£i.</p>
<p><strong>Liá»‡u ráº±ng pháº§n tá»­ cuá»‘i cÃ¹ng trong hÃ ng Ä‘á»£i kia cÃ²n Ã½ nghÄ©a gÃ¬ trong viá»‡c tÃ­nh giÃ¡ trá»‹ nhá» nháº¥t ná»¯a khÃ´ng?</strong></p>
<p>CÃ¢u tráº£ lá»i lÃ  $khÃ´ng$. VÃ¬ nÃ³ Ä‘Ã£ khÃ´ng pháº£i lÃ  giÃ¡ trá»‹ nhá» nháº¥t trong Ä‘oáº¡n $[i - k+ 1 â€¦ i]$ rá»“i thÃ¬ cÃ ng khÃ´ng thá»ƒ lÃ  giÃ¡ trá»‹ nhá» nháº¥t trong Ä‘oáº¡n $[(i + 1) - k + 1 â€¦ i + 1]$.</p>
<p>VÃ¬ váº­y ta sáº½ loáº¡i bá» táº¥t cáº£ cÃ¡c pháº§n tá»­ cuá»‘i cÃ¹ng trong deque náº¿u nÃ³ cÃ³ giÃ¡ trá»‹ lá»›n hÆ¡n hoáº·c báº±ng giÃ¡ trá»‹ $A[i]$ Ä‘ang xÃ©t.</p>
<p>Sau khi loáº¡i bá» táº¥t cáº£ cÃ¡c pháº§n tá»­ cuá»‘i cÃ¹ng vÃ  Ä‘áº©y pháº§n tá»­ $i = 5$ vÃ o thÃ¬ hÃ ng Ä‘á»£i sáº½ cÃ³ nhá»¯ng giÃ¡ trá»‹ sau:</p>
<p><img src="https://i.imgur.com/yZG8HOO.png" />
Ta tiáº¿p tá»¥c Ä‘áº©y pháº§n tá»­ thá»© $6$ vÃ o deque
<img src="https://i.imgur.com/VPJM6Bd.png" />
Sau Ä‘Ã³ ta tiáº¿p tá»¥c Ä‘áº©y pháº§n tá»­ thá»© $7$ vÃ o deque
<img src="https://i.imgur.com/inVXc6C.png" />
Khi ta chuáº©n bá»‹ Ä‘áº©y pháº§n tá»­ thá»© $8$ vÃ o deque, ta nháº­n tháº¥y ráº±ng giÃ¡ trá»‹ cá»§a nÃ³ nhá» hÆ¡n giÃ¡ trá»‹ cá»§a pháº§n tá»­ cuá»‘i trong hÃ ng Ä‘á»£i. Do Ä‘Ã³ ta sáº½ loáº¡i bá» pháº§n tá»­ cuá»‘i cÃ¹ng trong deque cho Ä‘áº¿n khi giÃ¡ trá»‹ cá»§a pháº§n tá»­ cuá»‘i cÃ¹ng nhá» hÆ¡n giÃ¡ trá»‹ ta chuáº©n bá»‹ Ä‘áº©y vÃ o.
<img src="https://i.imgur.com/puUB3j7.png" />
Ta cÃ³ thá»ƒ rÃºt ra Ä‘Æ°á»£c cÃ¡c nháº­n xÃ©t quan trá»ng nhÆ° sau:</p>
<ul>
<li>á» má»i thá»i Ä‘iá»ƒm, giÃ¡ trá»‹ $A[i]$ trong deque luÃ´n tÄƒng nghiÃªm ngáº·t. Khi ta Ä‘áº©y pháº§n tá»­ thá»© $i$ vÃ o deque thÃ¬ nÃ³ luÃ´n lÃ  pháº§n tá»­ cÃ³ giÃ¡ trá»‹ lá»›n nháº¥t.</li>
<li>VÃ¬ Ä‘Ã¢y lÃ  dÃ£y tÄƒng nghiÃªm ngáº·t tháº¿ nÃªn pháº§n tá»­ Ä‘áº§u tiÃªn luÃ´n lÃ  pháº§n tá»­ nhá» nháº¥t. <strong>(ÄÃ¢y chÃ­nh lÃ  min trong Ä‘oáº¡n $[i - k + 1 â€¦ i]$)</strong>
</li>
<li>Táº¡i má»—i bÆ°á»›c tÃ­nh $minRange[i]$ ta chá»‰ loáº¡i bá» tá»‘i Ä‘a $1$ pháº§n tá»­ Ä‘áº§u deque khi nÃ³ khÃ´ng thuá»™c khoáº£ng Ä‘ang xÃ©t.</li>
<li>Má»—i pháº§n tá»­ chá»‰ Ä‘Æ°á»£c Ä‘áº©y vÃ o deque tá»‘i Ä‘a $1$ láº§n duy nháº¥t.</li>
</ul>
<p>Tá»« cÃ¡c nháº­n xÃ©t nhÆ° kia, ta cÃ³ thá»ƒ dá»… dÃ ng hÃ¬nh thÃ nh thuáº­t toÃ¡n. Ta duyá»‡t qua tá»«ng pháº§n tá»­:</p>
<ul>
<li>
<strong>BÆ°á»›c 1:</strong> Trong khi hÃ ng Ä‘á»£i khÃ¡c rá»—ng vÃ  giÃ¡ trá»‹ cá»§a pháº§n tá»­ cuá»‘i cÃ¹ng trong deque lá»›n hÆ¡n hoáº·c báº±ng giÃ¡ trá»‹ Ä‘ang xÃ©t hiá»‡n táº¡i thÃ¬ ta sáº½ Ä‘áº©y háº¿t ra khá»i hÃ ng Ä‘á»£i.</li>
<li>
<strong>BÆ°á»›c 2:</strong> Äáº©y vá»‹ trÃ­ $i$ cá»§a pháº§n tá»­ Ä‘ang xÃ©t hiá»‡n táº¡i vÃ o cuá»‘i deque. (Ta khÃ´ng nÃªn Ä‘áº©y giÃ¡ trá»‹ $A[i]$ vÃ o bÃªn trong hÃ ng Ä‘á»£i. VÃ¬ lÃ m nhÆ° tháº¿ thÃ¬ ta sáº½ ráº¥t khÃ³ trong viá»‡c quáº£n lÃ½ Ä‘oáº¡n cáº§n láº¥y káº¿t quáº£)</li>
<li>
<strong>BÆ°á»›c 3:</strong> Náº¿u vá»‹ trá»‹ cá»§a pháº§n tá»­ Ä‘áº§u tiÃªn trong hÃ ng Ä‘á»£i khÃ´ng náº±m trong khoáº£ng Ä‘oáº¡n xÃ©t thÃ¬ ta loáº¡i bá» nÃ³.</li>
<li>
<strong>BÆ°á»›c 4:</strong> ÄÃ¡p Ã¡n cáº§n tÃ¬m chÃ­nh lÃ  giÃ¡ trá»‹ cá»§a pháº§n tá»­ Ä‘áº§u tiÃªn trong deque.</li>
</ul>
<h2 class="editable"><a class="anchor" id="cÃ i-Ä‘áº·t" href="#cÃ i-Ä‘áº·t"></a><strong>CÃ i Ä‘áº·t</strong></h2>
<p><strong>TÃ¬m min trong Ä‘oáº¡n tá»‹nh tiáº¿n</strong></p>
<p><strong>Ta cáº§n pháº£i sá»­ dá»¥ng nhá»¯ng cáº¥u trÃºc sau:</strong></p>
<ul>
<li>Cáº¥u trÃºc dá»¯ liá»‡u hÃ ng Ä‘á»£i hai Ä‘áº§u: $deque$ - LÆ°u láº¡i vá»‹ trÃ­ cá»§a pháº§n tá»­ cÃ³ giÃ¡ trá»‹ nhá» nháº¥t</li>
<li>Máº£ng $A$, lÆ°u cÃ¡c pháº§n tá»­ nháº­p vÃ o, tá»‘n $O(N)$ bá»™ nhá»›</li>
<li>Máº£ng $minRange$, lÆ°u Ä‘Ã¡p Ã¡n cá»§a bÃ i toÃ¡n, tá»‘n $O(N)$ bá»™ nhá»›</li>
<li>Äá»ƒ dá»… cÃ i Ä‘áº·t thÃ¬ ta chá»‰ cáº§n Ä‘áº©y vá»‹ trÃ­ $i$ vÃ o hÃ ng Ä‘á»£i. Khi ta cÃ³ vá»‹ trá»‹ $i$ thÃ¬ ta hoÃ n toÃ n cÃ³ giÃ¡ trá»‹ $A[i]$ tÆ°Æ¡ng á»©ng.</li>
</ul>
<pre class="highlight"><code><span class="n">deque</span> <span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">dq</span><span class="p">;</span>

<span class="cm">/* LÃ m rá»—ng deque */</span>
<span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="n">dq</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>

<span class="cm">/* Duyá»‡t láº§n lÆ°á»£t cÃ¡c pháº§n tá»­ tá»« 1 Ä‘áº¿n N */</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span> 
    <span class="cm">/* Loáº¡i bá» cÃ¡c pháº§n tá»­ cÃ³ giÃ¡ trá»‹ lá»›n hÆ¡n hoáº·c báº±ng A[i] */</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">A</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">back</span><span class="p">()]</span> <span class="o">&gt;=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">dq</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
    
    <span class="cm">/* Äáº©y pháº§n tá»­ i vÃ o queue */</span>
    <span class="n">dq</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> 
    
    <span class="cm">/* Náº¿u pháº§n tá»­ Ä‘áº§u tiÃªn trong deque náº±m ngoÃ i khoáº£ng tÃ­nh 
       thÃ¬ ta sáº½ loáº¡i bá» ra khá»i deque */</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">+</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">i</span><span class="p">)</span> <span class="n">dq</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span> 
    
    <span class="cm">/* minRange[i] lÃ  giÃ¡ trá»‹ nhá» nháº¥t trong Ä‘oáº¡n [i â€“ k + 1 â€¦ i] */</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">k</span><span class="p">)</span> <span class="n">minRange</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()];</span> 
<span class="p">}</span></code></pre>
<h2 class="editable"><a class="anchor" id="Ä‘Ã¡nh-giÃ¡" href="#Ä‘Ã¡nh-giÃ¡"></a><strong>ÄÃ¡nh giÃ¡</strong></h2>
<p>Táº¥t cáº£ cÃ¡c thao tÃ¡c cÆ¡ báº£n trÃªn deque <strong>(pop_back(), pop_front() vÃ  push_back())</strong> cÃ³ thá»ƒ dá»… dÃ ng Ä‘Æ°á»£c thá»±c hiá»‡n vá»›i thá»i gian cháº¡y lÃ  $O(1)$.
Má»—i pháº§n tá»­ vÃ o deque Ä‘Ãºng $1$ láº§n vÃ  bá»‹ loáº¡i bá» Ä‘Ãºng $1$ láº§n nÃªn Ä‘á»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n nÃ y khi xÃ¢y dá»±ng lÃ  $O(N)$ trong má»—i láº§n tÃ¬m $min$ trong Ä‘oáº¡n tá»‹nh tiáº¿n.</p>
<h2 class="editable"><a class="anchor" id="má»Ÿ-rá»™ng" href="#má»Ÿ-rá»™ng"></a><strong>Má»Ÿ rá»™ng</strong></h2>
<h3 class="editable"><a class="anchor" id="tÃ¬m-giÃ¡-trá»‹-lá»›n-nháº¥t" href="#tÃ¬m-giÃ¡-trá»‹-lá»›n-nháº¥t"></a><strong>TÃ¬m giÃ¡ trá»‹ lá»›n nháº¥t</strong></h3>
<p>Äá»ƒ tÃ¬m giÃ¡ trá»‹ lá»›n nháº¥t thÃ¬ ta lÃ m ngÆ°á»£c láº¡i quÃ¡ trÃ¬nh tÃ¬m giÃ¡ trá»‹ nhá» nháº¥t.</p>
<p>Ta sáº½ táº¡o $1$ deque nháº±m má»¥c Ä‘Ã­ch lÆ°u vá»‹ trÃ­ cá»§a pháº§n tá»­ cÃ³ giÃ¡ trá»‹ lá»›n nháº¥t.</p>
<p>á» bÆ°á»›c 1, thay vÃ¬ loáº¡i bá» cÃ¡c pháº§n tá»­ cÃ³ giÃ¡ trá»‹ lá»›n hÆ¡n hoáº·c báº±ng ra khá»i Ä‘áº§u deque thÃ¬ ta sáº½ loáº¡i bá» cÃ¡c pháº§n tá»­ cÃ³ giÃ¡ trá»‹ nhá» hÆ¡n hoáº·c báº±ng ra khá»i Ä‘áº§u deque. LÃºc nÃ y, pháº§n tá»­ Ä‘áº§u deque luÃ´n lÃ  pháº§n tá»­ lá»›n nháº¥t. VÃ  á»Ÿ má»i thá»i Ä‘iá»ƒm giÃ¡ trá»‹ trong deque luÃ´n lÃ  giáº£m nghiÃªm ngáº·t.</p>
<h3 class="editable"><a class="anchor" id="táº¡i-sao-ta-khÃ´ng-nÃªn-sá»­-dá»¥ng-cáº¥u-trÃºc-dá»¯-liá»‡u-cÃ¢y-phÃ¢n-Ä‘oáº¡n" href="#táº¡i-sao-ta-khÃ´ng-nÃªn-sá»­-dá»¥ng-cáº¥u-trÃºc-dá»¯-liá»‡u-cÃ¢y-phÃ¢n-Ä‘oáº¡n"></a><strong>Táº¡i sao ta khÃ´ng nÃªn sá»­ dá»¥ng cáº¥u trÃºc dá»¯ liá»‡u cÃ¢y phÃ¢n Ä‘oáº¡n?</strong></h3>
<p>Ta chá»‰ cÃ³ thá»ƒ giáº£i quyáº¿t bÃ i toÃ¡n nÃ y báº±ng cáº¥u trÃºc dá»¯ liá»‡u $Segment$ $Tree$.
Äá»ƒ xÃ¢y dá»±ng Ä‘Æ°á»£c cÃ¢y $Segment$ $Tree$ thÃ¬ chÃºng ta sáº½ pháº£i chuáº©n bá»‹:</p>
<ul>
<li>Bá»™ nhá»›: $O(N)$</li>
<li>Khá»Ÿi táº¡o: $O(log_{2}N)$</li>
<li>Ta pháº£i tráº£ lá»i $N - K + 1$ vá»‹ trÃ­. Do Ä‘Ã³ tá»•ng Ä‘á»™ phá»©c táº¡p sáº½ lÃ  $O(log_{2}N + (N - K + 1) \cdot log_{2}N)$</li>
</ul>
<h3 class="editable"><a class="anchor" id="khi-nÃ o-thÃ¬-khÃ´ng-thá»ƒ-dÃ¹ng-deque-Ä‘á»ƒ-tÃ¬m-max-min-trong-Ä‘oáº¡n-tá»‹nh-tiáº¿n" href="#khi-nÃ o-thÃ¬-khÃ´ng-thá»ƒ-dÃ¹ng-deque-Ä‘á»ƒ-tÃ¬m-max-min-trong-Ä‘oáº¡n-tá»‹nh-tiáº¿n"></a><strong>Khi nÃ o thÃ¬ khÃ´ng thá»ƒ dÃ¹ng deque Ä‘á»ƒ tÃ¬m max min trong Ä‘oáº¡n tá»‹nh tiáº¿n?</strong></h3>
<p>Vá»›i phÆ°Æ¡ng phÃ¡p dÃ¹ng deque Ä‘á»ƒ tÃ¬m $max-min$ trong Ä‘oáº¡n tá»‹nh tiáº¿n thÃ¬ báº¡n sáº½ khÃ´ng thá»ƒ giáº£i quyáº¿t Ä‘Æ°á»£c bÃ i toÃ¡n sau:</p>
<p><strong>Cho má»™t dÃ£y sá»‘ $A[i]$ $(1â‰¤ A[i] â‰¤10^9)$ cÃ³ $N (1 â‰¤ N â‰¤10^5)$ pháº§n tá»­. Cho $M (1 â‰¤ M â‰¤ 200,000)$ truy váº¥n cÃ³ dáº¡ng:</strong></p>
<ul>
<li>$0$ $pos$ $val$: Thay Ä‘á»•i giÃ¡ trá»‹ pháº§n tá»­ thá»© $pos$ thÃ nh $val$</li>
<li>$1$ $k$ $i$: TÃ­nh giÃ¡ trá»‹ nhá» nháº¥t trong Ä‘oáº¡n $[i - k + 1 â€¦ i]$ $(i - k + 1 â‰¥ 1)$</li>
<li>$2$ $k$ $i$: TÃ­nh giÃ¡ trá»‹ lá»›n nháº¥t trong Ä‘oáº¡n $[i â€¦ i + k - 1]$ $(i + k - 1 â‰¤ N)$</li>
</ul>
<p>NhÆ° Ä‘Ã£ trÃ¬nh bÃ y á»Ÿ trÃªn thÃ¬ Ä‘á»™ phá»©c táº¡p khi xÃ¢y dá»±ng kÄ© thuáº­t tÃ¬m $max-min$ trong Ä‘oáº¡n tá»‹nh tiáº¿n lÃ  $O(N)$</p>
<p>Tuy nhiÃªn thuáº­t toÃ¡n nÃ y chá»‰ thá»±c sá»± hiá»‡u quáº£ khi chÃºng ta khÃ´ng cÃ³ thao tÃ¡c cáº­p nháº­t láº¡i giÃ¡ trá»‹ cá»§a máº£ng. NÃ³i cÃ¡ch khÃ¡c thÃ¬ vá»›i phÆ°Æ¡ng phÃ¡p nÃ y chÃºng ta chá»‰ cÃ³ thá»ƒ Ã¡p dá»¥ng khi bÃ i toÃ¡n lÃ  bÃ i toÃ¡n xá»­ lÃ½ offine. LÃ½ do lÃ  bá»Ÿi giáº£ sá»­ chÃºng ta cÃ³ M thao tÃ¡c cáº­p nháº­t giÃ¡ trá»‹ mÃ  má»—i khi cáº­p nháº­t láº¡i giÃ¡ trá»‹ thÃ¬ ta sáº½ pháº£i tÃ­nh láº¡i max vÃ  min trong tá»«ng vá»‹ trÃ­ $i$ $(1 â‰¤ i â‰¤ N)$. LÃºc nÃ y thÃ¬ Ä‘á»™ phá»©c táº¡p cá»§a thuáº­t toÃ¡n sáº½ lÃ  $O(M \cdot N)$ vÃ  sáº½ bá»‹ quÃ¡ thá»i gian cho phÃ©p.</p>
<p>Äá»ƒ giáº£i quyáº¿t Ä‘Æ°á»£c bÃ i toÃ¡n nÃ y thÃ¬ chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cáº¥u trÃºc cÃ¢y phÃ¢n Ä‘oáº¡n vá»›i Ä‘á»™ phá»©c táº¡p lÃ  $O(Mlog_{2}N)$.</p>
<h2 class="editable"><a class="anchor" id="má»™t-sá»‘-lá»—i-thÆ°á»ng-gáº·p" href="#má»™t-sá»‘-lá»—i-thÆ°á»ng-gáº·p"></a><strong>Má»™t sá»‘ lá»—i thÆ°á»ng gáº·p</strong></h2>
<p>Khi láº¥y giÃ¡ trá»‹ trong deque ra thÃ¬ báº¡n chÆ°a kiá»ƒm tra hÃ ng Ä‘á»£i cá»§a mÃ¬nh cÃ³ Ä‘ang rá»—ng khÃ´ng? Náº¿u hÃ ng Ä‘á»£i rá»—ng mÃ  báº¡n váº«n láº¥y giÃ¡ trá»‹ $front()$ hoáº·c $back()$ thÃ¬ chÆ°Æ¡ng trÃ¬nh sáº½ sinh lá»—i.</p>
<h1 class="editable"><a class="anchor" id="bÃ i-toÃ¡n-2" href="#bÃ i-toÃ¡n-2"></a><strong>BÃ i toÃ¡n 2</strong></h1>
<h2 class="editable"><a class="anchor" id="Ä‘á»-bÃ i" href="#Ä‘á»-bÃ i"></a><strong>Äá» bÃ i</strong></h2>
<p>Trong má»™t round Ä‘áº¥u, rá»“ng tháº§n cá»§a Hoáº¡t cÃ³ thá»ƒ kháº¡c tá»‘i Ä‘a Ä‘áº¡t $N$ phÃ¡t chÃ­ máº¡ng vÃ o team Ä‘á»‹ch. SÃ¡t thÆ°Æ¡ng chÃ­ máº¡ng cá»§a láº§n kháº¡c thá»© $i$ gÃ¢y ra lÃ  $A_i$. Tuy nhiÃªn rá»“ng tháº§n cáº§n cÃ³ má»™t khoáº£ng thá»i gian Ä‘á»ƒ há»“i láº¡i mana. Váº­y nÃªn rá»“ng tháº§n khÃ´ng thá»ƒ kháº¡c $K$ láº§n chÃ­ máº¡ng liÃªn tiáº¿p.
Báº¡n hÃ£y chá»‰ cho Hoáº¡t cÃ¡ch Ä‘iá»u khiá»ƒn sá»©c máº¡nh cá»§a rá»“ng tháº§n sao cho tá»•ng sÃ¡t thÆ°Æ¡ng chÃ­ máº¡ng gÃ¢y ra cá»§a rá»“ng tháº§n lÃ  lá»›n nháº¥t.
<strong>Input:</strong></p>
<ul>
<li>DÃ²ng thá»© nháº¥t: chá»©a hai sá»‘ nguyÃªn $1 â‰¤ N â‰¤ 10^5; 2 â‰¤ K â‰¤ 10^5$</li>
<li>DÃ²ng thá»© hai chá»©a N sá»‘ nguyÃªn $A_1, A_2, â€¦, A_N$ $(1 â‰¤ A_i â‰¤ 10^4)$ â€“ sÃ¡t thÆ°Æ¡ng chÃ­ máº¡ng láº§n kháº¡c thá»© $i$ cá»§a rá»“ng tháº§n.</li>
</ul>
<p><strong>Output:</strong> Tá»•ng sÃ¡t thÆ°Æ¡ng chÃ­ máº¡ng lá»›n nháº¥t mÃ  rá»“ng tháº§n cÃ³ thá»ƒ gÃ¢y ra.</p>
<p><strong>Input:</strong>
</p><pre class="highlight"><code>7 3
1 4 2 3 6 5 9</code></pre>
<strong>Output:</strong>
<pre class="highlight"><code>23</code></pre>
<strong>Giáº£i thÃ­ch:</strong> Rá»“ng tháº§n sáº½ kháº¡c á»Ÿ nhá»¯ng thá»i Ä‘iá»ƒm $1$, $2$ rá»“i $4$, $5$ sau cÃ¹ng lÃ  $7$. Tá»•ng sÃ¡t thÆ°Æ¡ng sáº½ lÃ  $1 + 4 + 3 + 6 + 9 = 23$.
<h2 class="editable"><a class="anchor" id="phÃ¢n-tÃ­ch-1" href="#phÃ¢n-tÃ­ch-1"></a><strong>PhÃ¢n tÃ­ch</strong></h2>
<p>PhÃ¢n loáº¡i bÃ i: data structures, dp</p>
<p>Gá»i $dp[i]$ lÃ  tá»•ng sÃ¡t thÆ°Æ¡ng nhá» nháº¥t mÃ  rá»“ng tháº§n Ä‘Ã£ bá» qua khi xÃ©t Ä‘áº¿n vá»‹ trÃ­ $i$ vÃ  sáº½ tiáº¿p tá»¥c bá» qua phÃ¡t kháº¡c thá»© $i$
<strong>Khá»Ÿi táº¡o:</strong></p>
<ul>
<li>$dp[0] = 0$</li>
<li>$dp[i] = INF;$ vá»›i $\forall i: 1 â‰¤ i â‰¤ N + 1$</li>
</ul>
<p><strong>CÃ´ng thá»©c quy hoáº¡ch Ä‘á»™ng:</strong>
Vá»›i $\forall i: 1 â‰¤ i â‰¤ N + 1$ thÃ¬ $dp[i] = min(dp[j]) + A[i]$ $\forall j: max(1, i - K) â‰¤ j â‰¤ i - 1$
<strong>Káº¿t quáº£ cá»§a bÃ i toÃ¡n lÃ :</strong> Tá»•ng sÃ¡t thÆ°Æ¡ng cá»§a $N$ phÃ¡t kháº¡c trá»« Ä‘i $dp[N + 1]$
</p><pre class="highlight"><code><span class="n">dp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="n">INF</span><span class="p">;</span>
<span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">ans</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">K</span><span class="p">);</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> 
        <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">-</span> <span class="n">dp</span><span class="p">[</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span></code></pre>
<strong>Äá»™ phá»©c táº¡p:</strong> $O(N \cdot K)$
<strong>Nháº­n xÃ©t:</strong>
Ta cáº­p nháº­t giÃ¡ trá»‹ $dp[i]$ bá»Ÿi Ä‘oáº¡n cÃ¡c giÃ¡ trá»‹ $dp[j]$ liÃªn tá»¥c. Do Ä‘Ã³ ta cÃ³ thá»ƒ dá»… dÃ ng cÃ i Ä‘áº·t báº±ng cÃ¢y phÃ¢n Ä‘oáº¡n vá»›i Ä‘á»™ phá»©c táº¡p: $O(N \cdot log_{2}N)$
Tuy nhiÃªn ta nháº­n tháº¥y ráº±ng, Ä‘Ã¢y chÃ­nh lÃ  <strong>bÃ i toÃ¡n tÃ¬m min trong Ä‘oáº¡n tá»‹nh tiáº¿n</strong>. Ta sáº½ lÃ m tÆ°Æ¡ng tá»± nhÆ° bÃ i toÃ¡n $1$ vá»›i Ä‘á»™ phá»©c táº¡p: $O(N)$
<h2 class="editable"><a class="anchor" id="cÃ i-Ä‘áº·t-1" href="#cÃ i-Ä‘áº·t-1"></a><strong>CÃ i Ä‘áº·t</strong></h2>
<p><strong>Ta cáº§n pháº£i sá»­ dá»¥ng nhá»¯ng cáº¥u trÃºc sau:</strong></p>
<ul>
<li>Cáº¥u trÃºc dá»¯ liá»‡u hÃ ng Ä‘á»£i hai Ä‘áº§u: $deque$ - LÆ°u láº¡i vá»‹ trÃ­ cá»§a pháº§n tá»­ cÃ³ giÃ¡ trá»‹ nhá» nháº¥t</li>
<li>Máº£ng $A$, lÆ°u cÃ¡c pháº§n tá»­ nháº­p vÃ o, tá»‘n $O(N)$ bá»™ nhá»›</li>
<li>Máº£ng $dp$, lÆ°u Ä‘Ã¡p Ã¡n cá»§a bÃ i toÃ¡n, tá»‘n $O(N)$ bá»™ nhá»›</li>
<li>Äá»ƒ dá»… cÃ i Ä‘áº·t thÃ¬ ta chá»‰ cáº§n Ä‘áº©y vá»‹ trÃ­ $i$ vÃ o hÃ ng Ä‘á»£i. Khi ta cÃ³ vá»‹ trá»‹ $i$ thÃ¬ ta hoÃ n toÃ n cÃ³ giÃ¡ trá»‹ $dp[i]$ tÆ°Æ¡ng á»©ng.</li>
</ul>
<pre class="highlight"><code><span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">dq</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">-</span> <span class="n">K</span><span class="p">)</span> <span class="n">dq</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
    <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()]</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="n">ans</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">dp</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">back</span><span class="p">()]</span> <span class="o">&gt;=</span> <span class="n">dp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">dq</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
    <span class="n">dq</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">-</span> <span class="n">dp</span><span class="p">[</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span></code></pre>
<h1 class="editable"><a class="anchor" id="bÃ i-toÃ¡n-3" href="#bÃ i-toÃ¡n-3"></a><strong>BÃ i toÃ¡n 3</strong></h1>
<h2 class="editable"><a class="anchor" id="Ä‘á»-bÃ i-1" href="#Ä‘á»-bÃ i-1"></a><strong>Äá» bÃ i</strong></h2>
<p><strong>TÃ²a nhÃ  chá»c trá»i</strong>
CÃ³ $N$ tÃ²a nhÃ  chá»c trá»i Ä‘Æ°á»£c Ä‘Ã¡nh sá»‘ tá»« $1$ Ä‘áº¿n $N$. TÃ²a nhÃ  thá»© $i$ cÃ³ Ä‘á»™ cao lÃ  $H[i]$. Tá»« tÃ²a nhÃ  thá»© $i$ ta cÃ³ thá»ƒ nháº£y Ä‘áº¿n tÃ²a nhÃ  thá»© $j$ $(i &lt; j)$ náº¿u nhÆ° thá»a mÃ£n má»™t trong cÃ¡c Ä‘iá»u kiá»‡n sau:</p>
<ul>
<li>$i + 1 = j$</li>
<li>$max(H[i + 1], â€¦, H[j - 1]) &lt; min(H[i], H[j])$</li>
<li>$max(H[i], H[j]) &lt; min(H[i + 1], â€¦, H[j - 1])$</li>
</ul>
<p>Hiá»‡n táº¡i Gnar Ä‘ang Ä‘á»©ng trÃªn tÃ²a nhÃ  $1$. Má»¥c tiÃªu cá»§a anh áº¥y lÃ  nháº£y Ä‘áº¿n tÃ²a nhÃ  thá»© $N$ vá»›i sá»‘ láº§n nháº£y lÃ  Ã­t nháº¥t. HÃ£y giÃºp Gnar nhÃ©!!!
<strong>Äáº§u vÃ o:</strong></p>
<ul>
<li>DÃ²ng Ä‘áº§u tiÃªn chá»©a má»™t sá»‘ nguyÃªn duy nháº¥t $N$ $(2 â‰¤ N â‰¤ 3 \cdot 10^5)$ â€“ tá»•ng sá»‘ lÆ°á»£ng nhÃ  chá»c trá»i.</li>
<li>DÃ²ng thá»© hai chá»©a N sá»‘ nguyÃªn $H_1, H_2, â€¦, H_N$ $(1 â‰¤ H_i â‰¤ 10^9)$ â€“ chiá»u cao cá»§a cÃ¡c tÃ²a nhÃ  chá»c trá»i.</li>
</ul>
<p><strong>Äáº§u ra:</strong> In ra sá»‘ lÆ°á»£ng bÆ°á»›c nháº£y tá»‘i thiá»ƒu Ä‘á»ƒ Gnar cÃ³ thá»ƒ nháº£y Ä‘áº¿n tÃ²a nhÃ  thá»© $N$.</p>
<p><strong>VÃ­ dá»¥:</strong></p>
<p><strong>Input</strong>
</p><pre class="highlight"><code>5 
1 3 1 4 5</code></pre>
<strong>Output</strong>
<pre class="highlight"><code>3</code></pre>
<strong>Input</strong>
<pre class="highlight"><code>4 
4 2 2 4</code></pre>
<strong>Output</strong>
<pre class="highlight"><code>1</code></pre>
<strong>Input</strong>
<pre class="highlight"><code>5
100 1 100 1 100</code></pre>
<strong>Output</strong>
<pre class="highlight"><code>2</code></pre>
<strong>Báº¡n cÃ³ thá»ƒ ná»™p bÃ i táº¡i <a href="https://codeforces.com/contest/1407/problem/D">Ä‘Ã¢y</a></strong>
<h2 class="editable"><a class="anchor" id="phÃ¢n-tÃ­ch-2" href="#phÃ¢n-tÃ­ch-2"></a><strong>PhÃ¢n tÃ­ch</strong></h2>
<p><strong>PhÃ¢n loáº¡i bÃ i:</strong> data structures, dp, graph</p>
<p><strong>TrÆ°á»ng há»£p 1:</strong> Náº¿u $i + 1 = j$ thÃ¬ ta cÃ³ thá»ƒ xÃ¢y dá»±ng Ä‘á»“ thá»‹ cáº¡nh ná»‘i giá»¯a $i$ vÃ  $j$.</p>
<p><strong>TrÆ°á»ng há»£p 2:</strong> Náº¿u tÃ²a nhÃ  thá»© $i$ vÃ  $j$ thá»a mÃ£n Ä‘iá»u kiá»‡n $max(H[i + 1], â€¦, H[j - 1]) &lt; min(H[i], H[j])$ nghÄ©a lÃ  táº¥t cáº£ cÃ¡c tÃ²a nhÃ  náº±m giá»¯a $i$ vÃ  $j$ Ä‘á»u cÃ³ chiá»u cao nhá» hÆ¡n $min(H[i], H[j])$.</p>
<p>Äiá»u nÃ y cÃ³ nghÄ©a lÃ  tá»“n táº¡i tÃ²a nhÃ  $k$ $(i + 1 \le k \le j - 1)$ cÃ³ Ä‘á»™ cao lá»›n nháº¥t trong cÃ¡c tÃ²a nhÃ  tá»« $i + 1$ Ä‘áº¿n $j - 1$. Náº¿u $H[k] &lt; min(H[i], H[j])$ thÃ¬ táº¥t cáº£ cÃ¡c tÃ²a nhÃ  tá»« $i + 1$ Ä‘áº¿n $j - 1$ Ä‘á»u nhá» hÆ¡n $min(H[i], H[j])$.</p>
<p><img src="https://i.imgur.com/Tl3DSul.png" /></p>
<p><strong>LÃ m tháº¿ nÃ o Ä‘á»ƒ tÃ¬m Ä‘Æ°á»£c hai biÃªn nháº­n tÃ²a nhÃ  k lÃ m max?</strong>
VÃ¬ $max(H[i + 1], â€¦, H[j - 1]) &lt; min(H[i], H[j])$ nÃªn $H[k] &lt; min(H[i], H[j])$. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  cáº£ $2$ tÃ²a nhÃ  $i$ vÃ  $j$ Ä‘á»u lá»›n hÆ¡n tÃ²a nhÃ  $k$ do Ä‘Ã³ tÃ²a nhÃ  $i$ vÃ  $j$ sáº½ khÃ´ng náº±m trong khoáº£ng nháº­n tÃ²a nhÃ  $k$ lÃ  $max$.</p>
<p>Gá»i $L[k]$ lÃ  vá»‹ trÃ­ xa nháº¥t tÃ­nh tá»« vá»‹ trÃ­ $k$ vá» bÃªn trÃ¡i nháº­n Ä‘á»™ cao $H[k]$ lÃ  $max$</p>
<p>Gá»i $R[k]$ lÃ  vá»‹ trÃ­ xa nháº¥t tÃ­nh tá»« vá»‹ trÃ­ $k$ vá» bÃªn pháº£i nháº­n Ä‘á»™ cao $H[k]$ lÃ  $max$</p>
<p>Do Ä‘Ã³ tÃ²a nhÃ  $i$ sáº½ lÃ  $L[k] - 1$ vÃ  tÃ²a nhÃ  $j$ sáº½ lÃ  $R[k] + 1$.</p>
<p>VÃ¬ $max(H[L[k]] â€¦ H[R[k]]) = H[k]$ nÃªn náº¿u $H[k] &lt; min(H[L[k] - 1], H[R[k] + 1])$ thÃ¬ tá»« tÃ²a nhÃ  $L[k] - 1$ ta hoÃ n toÃ n cÃ³ thá»ƒ nháº£y Ä‘áº¿n tÃ²a nhÃ  $R[k] + 1$. Do Ä‘Ã³ ta xÃ¢y dá»±ng Ä‘á»“ thá»‹ cÃ³ cáº¡nh ná»‘i giá»¯a tÃ²a nhÃ  $L[k] - 1$ vá»›i tÃ²a nhÃ  $R[k] + 1$.</p>
<p><strong>Táº¡i sao khi tÃ¬m tÃ²a nhÃ  $i$, $j$ ta khÃ´ng tÃ¬m tÃ²a nhÃ  gáº§n nháº¥t mÃ  láº¡i pháº£i lÃ  xa nháº¥t?</strong></p>
<p>Giáº£ sá»­ tÃ²a nhÃ  gáº§n nháº¥t bÃªn trÃ¡i, bÃªn pháº£i nháº­n tÃ²a nhÃ  $k$ lÃ m $max$ láº§n lÆ°á»£t lÃ  $p$ vÃ  $q$. Khi ta tÃ¬m Ä‘Æ°á»£c 2 tÃ²a nhÃ  nÃ y thÃ¬ ta cÅ©ng cháº³ng thá»ƒ káº¿t luáº­n tÃ²a nhÃ  $p - 1$ cÃ³ thá»ƒ nháº£y sang tÃ²a nhÃ  $q + 1$. MÃ  giáº£ sá»­ $min(H[p - 1], H[q + 1]) &gt; H[k]$ thÃ¬ $p$, $q$ cÅ©ng lÃ  tÃ²a nhÃ  xa nháº¥t nháº­n tÃ²a nhÃ  $k$ lÃ m $max$.</p>
<p>VÃ¬ váº­y ta sáº½ xÃ©t táº¥t cáº£ cÃ¡c tÃ²a nhÃ  $k$ Ä‘á»ƒ cÃ³ thá»ƒ tÃ¬m Ä‘Æ°á»£c tÃ²a nhÃ  $i$ vÃ  $j$ thá»a mÃ£n yÃªu cáº§u Ä‘á» bÃ i.</p>
<p><strong>TrÆ°á»ng há»£p 3:</strong> Náº¿u tÃ²a nhÃ  thá»© $i$ vÃ  $j$ thá»a mÃ£n Ä‘iá»u kiá»‡n $max(H[i], H[j]) &lt; min(H[i + 1], â€¦, H[j - 1])$ nghÄ©a lÃ  táº¥t cáº£ cÃ¡c tÃ²a nhÃ  náº±m giá»¯a $i$ vÃ  $j$ Ä‘á»u cÃ³ Ä‘á»™ cao lá»›n hÆ¡n háº³n $max(H[i], H[j])$.
<img src="https://i.imgur.com/j5e9vEU.png" /></p>
<p>Láº­p luáº­n tÆ°Æ¡ng tá»±. á» trÆ°á»ng há»£p nÃ y ta sáº½ xÃ¢y dá»±ng $2$ máº£ng $l$ vÃ  $r$.</p>
<p>Gá»i $l[k]$ lÃ  vá»‹ trÃ­ xa nháº¥t tÃ­nh tá»« vá»‹ trÃ­ $k$ vá» bÃªn trÃ¡i nháº­n Ä‘á»™ cao $H[k]$ lÃ  $min$</p>
<p>Gá»i $r[k]$ lÃ  vá»‹ trÃ­ xa nháº¥t tÃ­nh tá»« vá»‹ trÃ­ $k$ vá» bÃªn pháº£i nháº­n Ä‘á»™ cao $H[k]$ lÃ  $min$</p>
<p>Äá»‘i vá»›i má»—i vá»‹ trÃ­ $k$ $(1 â‰¤ k â‰¤ N)$, $H[k]$ sáº½ lÃ  Ä‘á»™ cao nhá» nháº¥t trong Ä‘oáº¡n tá»« $l[k]$ Ä‘áº¿n $r[k]$. VÃ¬ $min(H[l[k]] â€¦ H[r[k]]) = H[k]$ nÃªn náº¿u $max(H[l[k] - 1], H[r[k] + 1]) &lt; H[k]$ thÃ¬ ta hoÃ n toÃ n cÃ³ thá»ƒ nháº£y tá»« tÃ²a nhÃ  $l[k] - 1$ sang tÃ²a nhÃ  $r[k] + 1$.</p>
<p>Do Ä‘Ã³ ta xÃ¢y dá»±ng Ä‘á»“ thá»‹ cÃ³ cáº¡nh ná»‘i giá»¯a tÃ²a nhÃ  $l[k] - 1$ vá»›i tÃ²a nhÃ  $r[k] + 1$</p>
<p>Khi Ä‘Ã£ xÃ¢y dá»±ng Ä‘Æ°á»£c Ä‘á»“ thá»‹ thÃ¬ cÃ³ thá»ƒ quy hoáº¡ch Ä‘á»™ng hoáº·c sá»­ dá»¥ng thuáº­t toÃ¡n tÃ¬m Ä‘Æ°á»ng Ä‘i ngáº¯n nháº¥t $BFS$ Ä‘á»ƒ tÃ­nh sá»‘ láº§n nháº£y Ã­t nháº¥t.</p>
<h2 class="editable"><a class="anchor" id="cÃ i-Ä‘áº·t-2" href="#cÃ i-Ä‘áº·t-2"></a><strong>CÃ i Ä‘áº·t</strong></h2>
<p><strong>XÃ¢y dá»±ng máº£ng L</strong>
</p><pre class="highlight"><code><span class="cm">/* L[k]: Xa nháº¥t vá» bÃªn trÃ¡i nháº­n H[k] lÃ  max */</span>
<span class="n">dq</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">H</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()]</span> <span class="o">&lt;=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="n">dq</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="n">L</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span> <span class="n">L</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
    <span class="n">dq</span><span class="p">.</span><span class="n">push_front</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
<span class="p">}</span></code></pre>
<p><strong>XÃ¢y dá»±ng máº£ng R</strong>
</p><pre class="highlight"><code><span class="cm">/* R[k]: Xa nháº¥t vá» bÃªn pháº£i nháº­n H[k] lÃ  max */</span>
<span class="n">dq</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="o">--</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">H</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()]</span> <span class="o">&lt;=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="n">dq</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="n">R</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span> <span class="n">R</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
    <span class="n">dq</span><span class="p">.</span><span class="n">push_front</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
<span class="p">}</span></code></pre>
<p><strong>XÃ¢y dá»±ng máº£ng l</strong>
</p><pre class="highlight"><code><span class="cm">/* l[k]: Xa nháº¥t vá» bÃªn trÃ¡i nháº­n H[k] lÃ  min*/</span>
<span class="n">dq</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">H</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()]</span> <span class="o">&gt;=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="n">dq</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="n">l</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span> <span class="n">l</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
    <span class="n">dq</span><span class="p">.</span><span class="n">push_front</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
<span class="p">}</span></code></pre>
<p><strong>XÃ¢y dá»±ng máº£ng r</strong>
</p><pre class="highlight"><code>  <span class="cm">/* r[k]: Xa nháº¥t vá» bÃªn pháº£i nháº­n H[k] lÃ  min */</span>
  <span class="n">dq</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="o">--</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">while</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">H</span><span class="p">[</span><span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()]</span> <span class="o">&gt;=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="n">dq</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">dq</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="n">r</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dq</span><span class="p">.</span><span class="n">front</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
      <span class="k">else</span> <span class="n">r</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
      <span class="n">dq</span><span class="p">.</span><span class="n">push_front</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
  <span class="p">}</span></code></pre>
<p><strong>XÃ¢y dá»±ng Ä‘á»“ thá»‹</strong>
</p><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">L</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="n">R</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
        <span class="n">G</span><span class="p">[</span><span class="n">L</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">max</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">H</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="p">{</span>
        <span class="n">G</span><span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
<h2 class="editable"><a class="anchor" id="Ä‘Ã¡nh-giÃ¡-1" href="#Ä‘Ã¡nh-giÃ¡-1"></a><strong>ÄÃ¡nh giÃ¡</strong></h2>
<ul>
<li>Sá»‘ cáº¡nh tá»‘i Ä‘a trong bÃ i toÃ¡n nÃ y: $M = 3 \cdot N$</li>
<li>Chi phÃ­ thá»i gian xÃ¢y dá»±ng 4 máº£ng $L, R, l, r$ lÃ  $O(N)$</li>
<li>Chi phÃ­ thá»i gian thuáº­t toÃ¡n $BFS$ lÃ  $O(N + M)$</li>
</ul>
<h1 class="editable"><a class="anchor" id="bÃ i-táº­p-Ã¡p-dá»¥ng" href="#bÃ i-táº­p-Ã¡p-dá»¥ng"></a><strong>BÃ i táº­p Ã¡p dá»¥ng</strong></h1>
<ul>
<li><a href="https://oj.vnoi.info/problem/mink">MINK</a></li>
<li><a href="https://oj.vnoi.info/problem/qbrect">QBRECT</a></li>
<li><a href="https://oj.vnoi.info/problem/kagain">KAGAIN</a></li>
<li><a href="https://oj.vnoi.info/problem/kplank">KPLANK</a></li>
<li><a href="https://oj.vnoi.info/problem/mmass">MMASS</a></li>
</ul>
</div>
</div>
</div>
</div>
